<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ëˆ ì•ˆ ê°šëŠ” ì¹œêµ¬ - ì´í´ë¦½ìŠ¤ ë§ˆì¸ë“œë©</title>
  
  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#7c3aed">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #09090b;
      color: #fff;
      min-height: 100vh;
      padding: 24px;
      line-height: 1.6;
    }
    
    .container { max-width: 540px; margin: 0 auto; }
    
    .header { margin-bottom: 32px; }

    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #71717a;
      text-decoration: none;
      font-size: 14px;
      margin-bottom: 16px;
    }

    .back-btn:hover { color: #a78bfa; }

    .header-content { text-align: center; }
    .header-category { font-size: 12px; color: #a78bfa; margin-bottom: 8px; }
    .header h1 { font-size: 22px; color: #fff; margin-bottom: 4px; }
    .header p { font-size: 14px; color: #71717a; }
    
    .progress { display: flex; gap: 8px; margin-bottom: 24px; }
    
    .progress-bar {
      height: 4px;
      flex: 1;
      border-radius: 4px;
      background: #27272a;
      transition: background 0.3s;
    }
    
    .progress-bar.completed { background: #a78bfa; }
    .progress-bar.current { background: rgba(167, 139, 250, 0.5); }
    
    .scenario-card {
      background: #18181b;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
    }

    .stage-label {
      font-size: 11px;
      color: #71717a;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .context {
      font-size: 13px;
      color: #a1a1aa;
      margin-bottom: 12px;
      padding: 12px;
      background: #1f1f23;
      border-radius: 8px;
    }
    
    .situation { font-size: 17px; line-height: 1.8; }
    
    .choices { display: flex; flex-direction: column; gap: 12px; }
    
    .choice-btn {
      width: 100%;
      text-align: left;
      padding: 16px;
      background: #18181b;
      border: 1px solid #27272a;
      border-radius: 12px;
      color: #fff;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.2s;
      line-height: 1.6;
    }
    
    .choice-btn:hover {
      background: #27272a;
      border-color: #3f3f46;
    }
    
    .result-section { display: none; }
    .result-section.show { display: block; }
    
    .selected-choice {
      padding: 16px;
      background: #18181b;
      border: 2px solid #3f3f46;
      border-radius: 12px;
      margin-bottom: 16px;
    }
    
    .selected-header { font-size: 13px; color: #71717a; margin-bottom: 8px; }
    .selected-text { color: #d4d4d8; line-height: 1.6; }
    
    .outcome-card {
      padding: 16px;
      background: rgba(24, 24, 27, 0.5);
      border-radius: 12px;
      margin-bottom: 16px;
    }
    
    .outcome-label { font-size: 13px; color: #71717a; margin-bottom: 8px; }
    .outcome-text { color: #d4d4d8; line-height: 1.8; }
    
    .principle-card {
      padding: 20px;
      background: linear-gradient(135deg, rgba(167, 139, 250, 0.15), #18181b);
      border: 1px solid rgba(167, 139, 250, 0.3);
      border-radius: 12px;
      margin-bottom: 16px;
    }
    
    .principle-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .principle-icon { font-size: 20px; }
    .principle-label {
      font-size: 11px;
      color: #a78bfa;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .principle-name { color: #fff; font-weight: 600; font-size: 16px; margin-bottom: 8px; }
    .principle-explanation { color: #a1a1aa; line-height: 1.8; font-size: 14px; }

    .evaluation-card {
      display: flex;
      gap: 12px;
      padding: 14px 16px;
      border-radius: 12px;
      margin-bottom: 16px;
      align-items: flex-start;
    }

    .evaluation-card.positive {
      background: rgba(74, 222, 128, 0.1);
      border: 1px solid rgba(74, 222, 128, 0.3);
    }

    .evaluation-card.neutral {
      background: rgba(251, 191, 36, 0.1);
      border: 1px solid rgba(251, 191, 36, 0.3);
    }

    .evaluation-card.negative {
      background: rgba(248, 113, 113, 0.1);
      border: 1px solid rgba(248, 113, 113, 0.3);
    }

    .evaluation-icon { font-size: 18px; flex-shrink: 0; }
    .evaluation-text { font-size: 14px; line-height: 1.7; }

    .evaluation-card.positive .evaluation-text { color: #4ade80; }
    .evaluation-card.neutral .evaluation-text { color: #fbbf24; }
    .evaluation-card.negative .evaluation-text { color: #f87171; }

    .other-choices-section { margin-bottom: 16px; }

    .other-choices-toggle {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 12px;
      background: transparent;
      border: 1px solid #27272a;
      border-radius: 10px;
      color: #71717a;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .other-choices-toggle:hover {
      border-color: #3f3f46;
      color: #a1a1aa;
    }

    .other-choices-toggle.open {
      border-color: #3f3f46;
      background: #18181b;
    }

    .other-choices-toggle.open svg { transform: rotate(180deg); }

    .other-choices-content {
      margin-top: 12px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .other-choices-content.hidden { display: none; }

    .other-choice-card {
      background: #131316;
      border: 1px solid #1f1f23;
      border-radius: 12px;
      padding: 14px;
    }

    .other-choice-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .eval-badge {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 10px;
    }

    .eval-badge.positive { background: rgba(74, 222, 128, 0.2); color: #4ade80; }
    .eval-badge.neutral { background: rgba(251, 191, 36, 0.2); color: #fbbf24; }
    .eval-badge.negative { background: rgba(248, 113, 113, 0.2); color: #f87171; }

    .other-choice-text { font-size: 14px; color: #a1a1aa; margin-bottom: 10px; line-height: 1.6; }

    .other-choice-outcome {
      font-size: 13px;
      color: #71717a;
      margin-bottom: 10px;
      padding: 10px;
      background: #18181b;
      border-radius: 8px;
      line-height: 1.6;
    }

    .other-choice-eval {
      font-size: 12px;
      color: #a1a1aa;
      margin-bottom: 10px;
      padding: 8px 10px;
      background: rgba(39, 39, 42, 0.5);
      border-radius: 6px;
      line-height: 1.6;
    }

    .other-choice-principle { font-size: 12px; color: #71717a; }
    .other-choice-principle strong { color: #a78bfa; }

    .next-btn {
      width: 100%;
      padding: 16px;
      background: #7c3aed;
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .next-btn:hover { background: #6d28d9; }
    
    .final-screen { display: none; padding: 20px 0; }
    .final-screen.show { display: block; }

    .clear-card {
      background: linear-gradient(135deg, #1f1f23, #18181b);
      border: 1px solid #27272a;
      border-radius: 20px;
      padding: 32px 24px;
      margin-bottom: 24px;
      text-align: center;
    }

    .clear-icon { font-size: 56px; margin-bottom: 16px; }
    .clear-title { font-size: 24px; font-weight: 700; margin-bottom: 8px; }
    .clear-subtitle { font-size: 14px; color: #71717a; margin-bottom: 20px; }

    .clear-exp {
      display: inline-block;
      padding: 8px 16px;
      background: rgba(167, 139, 250, 0.2);
      border-radius: 20px;
      color: #a78bfa;
      font-weight: 600;
    }

    .principles-collected {
      background: #18181b;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 24px;
    }

    .principles-title { font-size: 14px; color: #71717a; margin-bottom: 16px; }

    .principle-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px;
      background: #1f1f23;
      border-radius: 10px;
      margin-bottom: 8px;
    }

    .principle-item:last-child { margin-bottom: 0; }
    .principle-item-icon { font-size: 20px; flex-shrink: 0; }
    .principle-item-content { flex: 1; }
    .principle-item-name { font-size: 14px; font-weight: 600; margin-bottom: 4px; }
    .principle-item-desc { font-size: 12px; color: #71717a; line-height: 1.5; }

    .share-section { margin-bottom: 24px; }
    .share-label { font-size: 14px; color: #71717a; margin-bottom: 12px; text-align: center; }
    .share-buttons { display: flex; gap: 10px; justify-content: center; }
    
    .share-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 12px 18px;
      background: #27272a;
      border: 1px solid #3f3f46;
      border-radius: 10px;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .share-btn:hover { background: #3f3f46; }
    .share-btn.success { background: #166534; border-color: #22c55e; }

    .action-buttons { display: flex; flex-direction: column; gap: 10px; }
    
    .home-btn {
      width: 100%;
      padding: 16px;
      background: #7c3aed;
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      display: block;
      text-align: center;
    }

    .home-btn:hover { background: #6d28d9; }

    .restart-btn {
      width: 100%;
      padding: 16px;
      background: transparent;
      border: 1px solid #3f3f46;
      border-radius: 12px;
      color: #a1a1aa;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .restart-btn:hover { background: #27272a; color: #fff; }

    .install-btn {
      width: 100%;
      margin-top: 8px;
      padding: 14px;
      background: linear-gradient(135deg, #7c3aed, #5b21b6);
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .install-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4);
    }

    .install-btn.hidden { display: none; }

    .promo-section {
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid #27272a;
    }

    .eclipse-section {
      text-align: center;
      margin-bottom: 24px;
    }
    
    .eclipse-section-title {
      font-size: 14px;
      color: #71717a;
      margin-bottom: 16px;
    }
    
    .youtube-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 14px 32px;
      background: #27272a;
      border: 1px solid #3f3f46;
      border-radius: 12px;
      color: #fff;
      font-size: 15px;
      font-weight: 500;
      text-decoration: none;
      transition: all 0.2s;
    }
    
    .youtube-btn:hover {
      background: #3f3f46;
      transform: translateY(-2px);
    }
    
    .youtube-btn svg { fill: #ff0000; }
    
    .books-section {
      text-align: center;
      padding-top: 24px;
      border-top: 1px solid #27272a;
    }
    
    .books-section-title {
      font-size: 14px;
      color: #71717a;
      margin-bottom: 20px;
    }
    
    .books-grid {
      display: flex;
      gap: 16px;
      justify-content: center;
    }
    
    .book-item {
      flex: 1;
      max-width: 140px;
      text-decoration: none;
      color: #fff;
      transition: all 0.2s;
    }
    
    .book-item:hover { transform: translateY(-4px); }
    
    .book-item img {
      width: 100%;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      margin-bottom: 10px;
    }
    
    .book-item-title { font-size: 13px; color: #a1a1aa; }

    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <a href="index.html" class="back-btn">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        ëŒì•„ê°€ê¸°
      </a>
      <div class="header-content">
        <div class="header-category">ì‹¬ë¦¬ Â· ì¸ê°„ê´€ê³„</div>
        <h1>ëˆ ì•ˆ ê°šëŠ” ì¹œêµ¬</h1>
        <p>3ê°œì›”ì§¸ 30ë§Œì›ì„ ì•ˆ ê°šëŠ” ì¹œêµ¬, ì–´ë–»ê²Œ í• ê¹Œ?</p>
      </div>
    </div>
    
    <div class="progress" id="progress"></div>
    
    <div id="game-screen">
      <div class="scenario-card">
        <div class="stage-label" id="stage-label">Stage 1</div>
        <div class="context" id="context"></div>
        <div class="situation" id="situation"></div>
      </div>
      
      <div class="choices" id="choices"></div>
      
      <div class="result-section" id="result-section">
        <div class="selected-choice">
          <div class="selected-header">ì„ íƒí•œ ë‹µë³€</div>
          <div class="selected-text" id="selected-text"></div>
        </div>
        
        <div class="outcome-card">
          <div class="outcome-label">ìƒëŒ€ë°©ì˜ ë°˜ì‘</div>
          <div class="outcome-text" id="outcome-text"></div>
        </div>
        
        <div class="principle-card">
          <div class="principle-header">
            <span class="principle-icon">ğŸ’¡</span>
            <span class="principle-label">ë°œê²¬í•œ ì›ì¹™</span>
          </div>
          <div class="principle-name" id="principle-name"></div>
          <div class="principle-explanation" id="principle-explanation"></div>
        </div>

        <div class="evaluation-card" id="evaluation-card">
          <div class="evaluation-icon" id="evaluation-icon">âš ï¸</div>
          <div class="evaluation-text" id="evaluation-text"></div>
        </div>

        <div class="other-choices-section">
          <button class="other-choices-toggle" id="other-toggle">
            <span>ë‹¤ë¥¸ ì„ íƒì€?</span>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </button>
          <div class="other-choices-content hidden" id="other-choices-content"></div>
        </div>
        
        <button class="next-btn" id="next-btn">ë‹¤ìŒ ìƒí™©</button>
      </div>
    </div>
    
    <div class="final-screen" id="final-screen">
      <div class="clear-card">
        <div class="clear-icon">ğŸ’°</div>
        <div class="clear-title">ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ!</div>
        <div class="clear-subtitle">ëˆ ì•ˆ ê°šëŠ” ì¹œêµ¬ ìƒí™©ì„ í´ë¦¬ì–´í–ˆìŠµë‹ˆë‹¤</div>
        <div class="clear-exp">+30 EXP íšë“!</div>
      </div>

      <div class="principles-collected">
        <div class="principles-title">ğŸ”“ ë°œê²¬í•œ ì›ì¹™ë“¤</div>
        <div id="principles-list"></div>
      </div>

      <div class="share-section">
        <div class="share-label">ì¹œêµ¬ì—ê²Œ ê³µìœ í•˜ê¸°</div>
        <div class="share-buttons">
          <button class="share-btn" id="native-share-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
              <polyline points="16 6 12 2 8 6"/>
              <line x1="12" y1="2" x2="12" y2="15"/>
            </svg>
            ê³µìœ í•˜ê¸°
          </button>
          <button class="share-btn" id="copy-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
            ë§í¬ ë³µì‚¬
          </button>
        </div>
      </div>

      <div class="action-buttons">
        <a href="index.html" class="home-btn">íƒí—˜ ì§€ë„ë¡œ ëŒì•„ê°€ê¸°</a>
        <button class="restart-btn" id="restart-btn">ë‹¤ì‹œ í•´ë³´ê¸°</button>
        <button class="install-btn hidden" id="installBtn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          ì•±ìœ¼ë¡œ ì„¤ì¹˜í•˜ê³  ê³„ì† íƒí—˜í•˜ê¸°
        </button>
      </div>

      <div class="promo-section">
        <div class="eclipse-section">
          <div class="eclipse-section-title">ì´í´ë¦½ìŠ¤ ë” ì•Œì•„ë³´ê¸°</div>
          <a href="https://www.youtube.com/@Eclipse-g4e" target="_blank" class="youtube-btn">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814z"/>
              <path fill="#fff" d="M9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
            </svg>
            ìœ íŠœë¸Œ ì±„ë„
          </a>
        </div>

        <div class="books-section">
          <div class="books-section-title">ì´í´ë¦½ìŠ¤ì˜ ì±…</div>
          <div class="books-grid">
            <a href="https://product.kyobobook.co.kr/detail/S000214938953" target="_blank" class="book-item">
              <img src="book-philosophy.png" alt="í›”ì¹œ ì² í•™ í¸">
              <div class="book-item-title">í›”ì¹œ ì² í•™ í¸</div>
            </a>
            <a href="https://product.kyobobook.co.kr/detail/S000214938954" target="_blank" class="book-item">
              <img src="book-psychology.png" alt="í›”ì¹œ ì‹¬ë¦¬í•™ í¸">
              <div class="book-item-title">í›”ì¹œ ì‹¬ë¦¬í•™ í¸</div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const SITE_URL = 'https://eclipse-mindlab.github.io/mindlab/';
    const STORAGE_KEY = 'eclipse_mindlab_profile';
    const SIM_ID = 'money_friend';

    const stages = [
      {
        id: 1,
        context: "3ê°œì›” ì „, ì¹œí•œ ì¹œêµ¬ê°€ ê¸‰í•˜ë‹¤ë©° 30ë§Œì›ì„ ë¹Œë ¤ê°”ë‹¤. 'ë‹¤ìŒ ë‹¬ì— ê°šì„ê²Œ'ë¼ê³  í–ˆì§€ë§Œ, ë‘ ë²ˆì˜ ì›”ê¸‰ë‚ ì´ ì§€ë‚¬ë‹¤. ê·¸ë™ì•ˆ ì¹œêµ¬ëŠ” ë°¥ë„ ì‚¬ê³ , SNSì— ì¹´í˜ ì‚¬ì§„ë„ ì˜¬ë¦¬ê³  ìˆë‹¤.",
        situation: "ì˜¤ëŠ˜ ë˜ ë‹¨í†¡ë°©ì—ì„œ ì¹œêµ¬ê°€ ì›ƒìœ¼ë©° ëŒ€í™”í•˜ê³  ìˆë‹¤. ì–´ë–»ê²Œ ì‹œì‘í• ê¹Œ?",
        choices: [
          {
            text: "ë‹¨í†¡ë°©ì—ì„œ 'ì•¼ ê·¸ 30ë§Œì› ì–¸ì œ ì¤„ ê±°ì•¼?'ë¼ê³  ë§í•œë‹¤",
            outcome: "ì¹œêµ¬ê°€ 'ì•„ ã…‹ã…‹ ë¯¸ì•ˆ ê³§ ì¤„ê²Œ~'ë¼ê³  ëŒ€ì¶© ë„˜ê¸´ë‹¤. ë‹¤ë¥¸ ì¹œêµ¬ë“¤ë„ ì–´ìƒ‰í•´í•œë‹¤. ì¹œêµ¬ëŠ” ì°½í”¼ë¥¼ ë‹¹í–ˆë‹¤ê³  ëŠë‚€ë‹¤.",
            principle: "ê³µê°œì  ì••ë°•ì˜ ì—­íš¨ê³¼",
            principleDesc: "ê³µê°œì  ë§ì‹ ì€ ìƒëŒ€ì˜ ì²´ë©´ì„ êµ¬ê¸´ë‹¤. ì²´ë©´ì„ ìƒì€ ì‚¬ëŒì€ ë°©ì–´ì ì´ ë˜ê³ , ê´€ê³„ê°€ í‹€ì–´ì§„ë‹¤. ë¬¸ì œëŠ” í•´ê²°ë˜ì§€ ì•ŠëŠ”ë‹¤.",
            evaluation: "negative",
            evalText: "ëˆë„ ëª» ë°›ê³  ê´€ê³„ë§Œ ë‚˜ë¹ ì¡Œë‹¤. ê³µê°œ ì••ë°•ì€ ìµœì•…ì˜ ì„ íƒ ì¤‘ í•˜ë‚˜ë‹¤.",
            nextStage: "stage2_public"
          },
          {
            text: "1:1 ì¹´í†¡ìœ¼ë¡œ 'í˜¹ì‹œ ì €ë²ˆì— ë¹Œë ¤ê°„ ëˆ ì–¸ì œì¯¤ ê°€ëŠ¥í• ê¹Œ?'ë¼ê³  ë³´ë‚¸ë‹¤",
            outcome: "ì¹œêµ¬ê°€ 'ì•„ ë§ë‹¤ ë¯¸ì•ˆ, ì´ë²ˆ ë‹¬ ë§ì—ëŠ” ê¼­!'ì´ë¼ê³  ë‹µí•œë‹¤. ì¼ë‹¨ ëŒ€í™”ëŠ” ì—´ë ¸ë‹¤.",
            principle: "ê°œì¸ì  ì ‘ê·¼",
            principleDesc: "1:1 ëŒ€í™”ëŠ” ìƒëŒ€ì—ê²Œ ì²´ë©´ì„ ì§€ì¼œì¤€ë‹¤. ì‚¬ëŒì€ ì²´ë©´ì´ ì§€ì¼œì§ˆ ë•Œ ë” í˜‘ì¡°ì ì´ ëœë‹¤.",
            evaluation: "positive",
            evalText: "ì¢‹ì€ ì‹œì‘ì´ë‹¤. ìƒëŒ€ê°€ ë°©ì–´ì ì´ì§€ ì•Šìœ¼ë‹ˆ ëŒ€í™”ê°€ ê°€ëŠ¥í•˜ë‹¤.",
            nextStage: "stage2_private"
          },
          {
            text: "ë” ê¸°ë‹¤ë ¤ë³¸ë‹¤. ì¹œêµ¬ë‹ˆê¹Œ ì•Œì•„ì„œ ê°šê² ì§€",
            outcome: "ì¼ì£¼ì¼ì´ ì§€ë‚¬ë‹¤. ì¹œêµ¬ëŠ” ì—¬ì „íˆ ë§ì´ ì—†ë‹¤. SNSì—ëŠ” ìƒˆë¡œ ì‚° ì˜· ì‚¬ì§„ì´ ì˜¬ë¼ì™”ë‹¤.",
            principle: "ì†Œê·¹ì  ê¸°ëŒ€ì˜ í•¨ì •",
            principleDesc: "ìƒëŒ€ê°€ 'ì•Œì•„ì„œ' í•´ì¤„ ê±°ë¼ëŠ” ê¸°ëŒ€ëŠ” ëŒ€ë¶€ë¶„ í‹€ë¦°ë‹¤. ëª…í™•í•œ ìš”ì²­ ì—†ì´ëŠ” ìƒëŒ€ì˜ ìš°ì„ ìˆœìœ„ì—ì„œ ë°€ë¦°ë‹¤.",
            evaluation: "negative",
            evalText: "ê¸°ë‹¤ë¦¼ì€ í•´ê²°ì±…ì´ ì•„ë‹ˆë‹¤. ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ëˆ ë°›ê¸° ì–´ë ¤ì›Œì§„ë‹¤.",
            nextStage: "stage2_wait"
          }
        ]
      },
      
      // Stage 2 - ê³µê°œ ì••ë°• í›„
      {
        id: "stage2_public",
        context: "ì¹œêµ¬ê°€ ê¸°ë¶„ ë‚˜ë¹ í•œë‹¤. ë©°ì¹  í›„, ì¹œêµ¬ì—ê²Œì„œ ì¹´í†¡ì´ ì™”ë‹¤. 'ì•¼, ì €ë²ˆì— ê·¸ë ‡ê²Œ ë§í•  ê±° ìˆì–´? ì°½í”¼í•˜ê²Œ...'",
        situation: "ê´€ê³„ê°€ í‹€ì–´ì§€ê³  ìˆë‹¤. ì–´ë–»ê²Œ ëŒ€ì‘í• ê¹Œ?",
        choices: [
          {
            text: "'ë‚´ê°€ ì˜ëª»í–ˆì–´? 3ê°œì›”ì´ë‚˜ ê¸°ë‹¤ë ¸ì–ì•„'ë¼ê³  ë°˜ë°•í•œë‹¤",
            outcome: "ì¹œêµ¬ê°€ 'ê·¸ë˜ ë‚´ê°€ ë¯¸ì•ˆí•˜ì§€. ê·¼ë° ê·¸ë ‡ê²Œ ë§í•˜ëŠ” ê±´ ì•„ë‹ˆì–ì•„'ë¼ë©° ê°ì •ì‹¸ì›€ì´ ëœë‹¤. ëˆ ì–˜ê¸°ëŠ” ë’·ì „ì´ ëë‹¤.",
            principle: "ê°ì • ëŒ€ ê°ì •ì˜ ì•…ìˆœí™˜",
            principleDesc: "ê°ì •ìœ¼ë¡œ ë§ë°›ì•„ì¹˜ë©´ ë…¼ì ì´ íë ¤ì§„ë‹¤. 'ëˆ„ê°€ ë” ì˜ëª»í–ˆë‚˜' ì‹¸ì›€ì€ ë¬¸ì œë¥¼ í•´ê²°í•˜ì§€ ëª»í•œë‹¤.",
            evaluation: "negative",
            evalText: "ëˆ ë¬¸ì œê°€ ê°ì • ë¬¸ì œë¡œ ë°”ë€Œì—ˆë‹¤. ìµœì•…ì˜ ë°©í–¥ìœ¼ë¡œ í˜ëŸ¬ê°€ê³  ìˆë‹¤.",
            nextStage: "stage3_fight"
          },
          {
            text: "'ë¯¸ì•ˆ, ë‚´ê°€ ê¸‰í•˜ê²Œ ë§í–ˆë‹¤. ê·¼ë° ìš°ë¦¬ ëˆ ë¬¸ì œëŠ” ì •ë¦¬í•˜ì'",
            outcome: "ì¹œêµ¬ê°€ '...ê·¸ë˜ ë‚˜ë„ ë¯¸ì•ˆí•´. ì§„ì§œ ì´ë²ˆ ë‹¬ì—ëŠ” ì¤„ê²Œ'ë¼ë©° í•œ ë°œ ë¬¼ëŸ¬ì„ ë‹¤.",
            principle: "ê°ì • ì¸ì • í›„ ë³¸ë¡ ",
            principleDesc: "ìƒëŒ€ì˜ ê°ì •ì„ ì¸ì •í•˜ë©´ ë°©ì–´ë²½ì´ ë‚®ì•„ì§„ë‹¤. ê·¸ ë‹¤ìŒì— ë³¸ë¡ ìœ¼ë¡œ ëŒì•„ê°€ë©´ í•©ì˜ê°€ ì‰¬ì›Œì§„ë‹¤.",
            evaluation: "positive",
            evalText: "ê´€ê³„ë¥¼ íšŒë³µí•˜ë©´ì„œ ë³¸ë¡ ë„ ì§šì—ˆë‹¤. ì¢‹ì€ ì „í™˜ì´ë‹¤.",
            nextStage: "stage3_recover"
          },
          {
            text: "ê·¸ëƒ¥ ì‚¬ê³¼ë§Œ í•œë‹¤. 'ë¯¸ì•ˆ, ë‚´ê°€ ì˜ˆë¯¼í–ˆë‚˜ë´'",
            outcome: "ì¹œêµ¬ê°€ 'ê´œì°®ì•„~' í•˜ë©° ë¶„ìœ„ê¸°ê°€ í’€ë ¸ë‹¤. í•˜ì§€ë§Œ ëˆ ì–˜ê¸°ëŠ” ë˜ ë¬»í˜”ë‹¤.",
            principle: "ê³¼ë„í•œ ì–‘ë³´",
            principleDesc: "ê´€ê³„ë¥¼ ìœ„í•´ ìì‹ ì˜ ê¶Œë¦¬ë¥¼ í¬ê¸°í•˜ë©´, ìƒëŒ€ëŠ” ê·¸ê²ƒì„ ë‹¹ì—°í•˜ê²Œ ì—¬ê¸°ê¸° ì‹œì‘í•œë‹¤.",
            evaluation: "neutral",
            evalText: "ê´€ê³„ëŠ” ì§€ì¼°ì§€ë§Œ, ëˆ ë°›ê¸°ëŠ” ë” ì–´ë ¤ì›Œì¡Œë‹¤.",
            nextStage: "stage3_doormat"
          }
        ]
      },
      
      // Stage 2 - 1:1 ì ‘ê·¼ í›„
      {
        id: "stage2_private",
        context: "'ì´ë²ˆ ë‹¬ ë§ì—ëŠ” ê¼­'ì´ë¼ê³  í–ˆë˜ ì¹œêµ¬. ê·¸ëŸ°ë° ì›”ë§ì´ ì§€ë‚¬ëŠ”ë° ì—°ë½ì´ ì—†ë‹¤.",
        situation: "ì•½ì†ì„ ë˜ ì–´ê²¼ë‹¤. ì–´ë–»ê²Œ í• ê¹Œ?",
        choices: [
          {
            text: "'ì €ë²ˆì— ì´ë²ˆ ë‹¬ì´ë¼ê³  í–ˆì–ì•„. ì–¸ì œ ê°€ëŠ¥í•´?'ë¼ê³  ë‹¤ì‹œ ë¬¼ì–´ë³¸ë‹¤",
            outcome: "ì¹œêµ¬ê°€ 'ì•„ ë¯¸ì•ˆ ìš”ì¦˜ ì¢€ ë¹ ë“¯í•´ì„œ... ì¡°ê¸ˆë§Œ ë” ê¸°ë‹¤ë ¤ì¤˜'ë¼ê³  í•œë‹¤. ë˜ ë¯¸ë¤„ì§„ë‹¤.",
            principle: "ë°˜ë³µë˜ëŠ” ì•½ì†ì˜ í‰ê°€ì ˆí•˜",
            principleDesc: "ì–´ê¸´ ì•½ì†ì´ ë°˜ë³µë˜ë©´ ë‹¤ìŒ ì•½ì†ì˜ ì‹ ë¢°ë„ê°€ ë–¨ì–´ì§„ë‹¤. êµ¬ì²´ì ì¸ ì¡°ê±´ì´ í•„ìš”í•˜ë‹¤.",
            evaluation: "neutral",
            evalText: "ê°™ì€ íŒ¨í„´ì´ ë°˜ë³µë˜ê³  ìˆë‹¤. ë‹¤ë¥¸ ì ‘ê·¼ì´ í•„ìš”í•˜ë‹¤.",
            nextStage: "stage3_deadline"
          },
          {
            text: "'í˜•í¸ì´ ì–´ë ¤ìš°ë©´ ë¶„í• ë¡œ ê°šì•„ë„ ë¼. ì´ë²ˆ ë‹¬ 10ë§Œì›ë§Œì´ë¼ë„?'",
            outcome: "ì¹œêµ¬ê°€ 'ì•„ ê·¸ë˜? ê·¸ ì •ë„ë©´ ë  ê²ƒ ê°™ì•„. ë‚´ì¼ ë³´ë‚¼ê²Œ'ë¼ë©° ìˆ˜ë½í•œë‹¤. ë‹¤ìŒ ë‚  ì •ë§ 10ë§Œì›ì´ ë“¤ì–´ì™”ë‹¤.",
            principle: "ì‘ì€ ë‹¨ìœ„ë¡œ ìª¼ê°œê¸°",
            principleDesc: "í° ê¸ˆì•¡ì€ ì‹¬ë¦¬ì  ë¶€ë‹´ì´ í¬ë‹¤. ì‘ê²Œ ë‚˜ëˆ„ë©´ ì‹¤í–‰ ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§„ë‹¤. í–‰ë™ê²½ì œí•™ì˜ 'ëª©í‘œ ì„¸ë¶„í™”' ì›ì¹™.",
            evaluation: "positive",
            evalText: "í›Œë¥­í•˜ë‹¤! ìƒëŒ€ê°€ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í˜„ì‹¤ì ì¸ ì œì•ˆì„ í–ˆë‹¤.",
            nextStage: "stage3_partial"
          },
          {
            text: "'ì‚¬ì •ì´ ìˆìœ¼ë©´ ë§í•´ì¤˜. ì–´ë ¤ìš°ë©´ ë°©ë²•ì„ ì°¾ì•„ë³´ì'",
            outcome: "ì¹œêµ¬ê°€ 'ì‚¬ì‹¤ ìš”ì¦˜ ì§„ì§œ í˜ë“¤ì–´ì„œ...'ë¼ë©° ìƒí™©ì„ í„¸ì–´ë†“ëŠ”ë‹¤. ì§„ì§œë¡œ ì–´ë ¤ìš´ ìƒí™©ì´ì—ˆë‹¤.",
            principle: "ì—´ë¦° ì§ˆë¬¸ê³¼ ê²½ì²­",
            principleDesc: "ìƒëŒ€ì˜ ìƒí™©ì„ ì´í•´í•˜ë©´ í•´ê²°ì±…ì´ ë³´ì¸ë‹¤. íŒë‹¨ ëŒ€ì‹  ê²½ì²­ì´ ë¨¼ì €ë‹¤.",
            evaluation: "positive",
            evalText: "ìƒëŒ€ì˜ ì§„ì§œ ìƒí™©ì„ ì•Œê²Œ ëë‹¤. ì´ì œ í˜„ì‹¤ì ì¸ í•´ê²°ì±…ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.",
            nextStage: "stage3_empathy"
          }
        ]
      },
      
      // Stage 2 - ê¸°ë‹¤ë¦° í›„
      {
        id: "stage2_wait",
        context: "í•œ ë‹¬ì´ ë” ì§€ë‚¬ë‹¤. ì´ì œ ë¹Œë ¤ì¤€ ì§€ 4ê°œì›”ì§¸. ì¹œêµ¬ëŠ” ì—¬ì „íˆ ë§ì´ ì—†ê³ , ì˜¤íˆë ¤ ë” ìì£¼ ë§Œë‚˜ìê³  í•œë‹¤.",
        situation: "ì´ì œ ì§„ì§œ ë§í•´ì•¼ í•  ê²ƒ ê°™ë‹¤. ì–´ë–»ê²Œ êº¼ë‚¼ê¹Œ?",
        choices: [
          {
            text: "ë§Œë‚˜ì„œ ì§ì ‘ ì–˜ê¸°í•œë‹¤. 'ìš°ë¦¬ ì €ë²ˆì— ë¹Œë ¤ì¤€ ëˆ ì–˜ê¸° ì¢€ í•˜ì'",
            outcome: "ì¹œêµ¬ê°€ ë‹¹í™©í•˜ë©° 'ì•„ ë§ë‹¤... ë‚´ê°€ ì§„ì§œ ë¯¸ì•ˆí•´. ê³„ì† ë§í•˜ë ¤ë‹¤ê°€...'ë¼ë©° ë¨¸ë­‡ê±°ë¦°ë‹¤.",
            principle: "ëŒ€ë©´ì˜ í˜",
            principleDesc: "ëŒ€ë©´ ëŒ€í™”ëŠ” íšŒí”¼í•˜ê¸° ì–´ë µë‹¤. ë¬¸ìë³´ë‹¤ ëŒ€ë©´ì—ì„œ ì‚¬ëŒë“¤ì€ ë” ì†”ì§í•´ì§€ê³  ì±…ì„ê°ì„ ëŠë‚€ë‹¤.",
            evaluation: "positive",
            evalText: "ì§ì ‘ ë§Œë‚˜ë‹ˆ ìƒëŒ€ë„ í”¼í•  ìˆ˜ ì—†ë‹¤. ì¢‹ì€ ì„ íƒì´ë‹¤.",
            nextStage: "stage3_faceto"
          },
          {
            text: "'ë‚˜ë„ ìš”ì¦˜ ì‚¬ì •ì´ ìˆì–´ì„œ... ì €ë²ˆì— ë¹Œë ¤ì¤€ ëˆ ì¢€ í•„ìš”í•´'",
            outcome: "ì¹œêµ¬ê°€ 'ì•„ ê·¸ë˜? ì•Œì•˜ì–´, ì¢€ ì•Œì•„ë³¼ê²Œ'ë¼ë©° ì§„ì§€í•´ì¡Œë‹¤. ë„¤ ìƒí™©ì„ ì•Œê²Œ ë˜ë‹ˆ ë°˜ì‘ì´ ë‹¬ë¼ì¡Œë‹¤.",
            principle: "ìê¸° ìƒí™© ê³µê°œ",
            principleDesc: "ìì‹ ì˜ í•„ìš”ë¥¼ ë°íˆë©´ ìš”ì²­ì´ ì •ë‹¹í•´ì§„ë‹¤. ìƒëŒ€ë„ 'ê·¸ëƒ¥ ì”ì†Œë¦¬'ê°€ ì•„ë‹Œ 'ì§„ì§œ í•„ìš”'ë¡œ ë°›ì•„ë“¤ì¸ë‹¤.",
            evaluation: "positive",
            evalText: "ë„¤ ìƒí™©ì„ ì•Œë¦¬ë‹ˆ ìƒëŒ€ê°€ ì‹¬ê°í•˜ê²Œ ë°›ì•„ë“¤ì¸ë‹¤.",
            nextStage: "stage3_need"
          },
          {
            text: "ê³µí†µ ì¹œêµ¬ì—ê²Œ 'ê±” ì¢€ ë§í•´ì¤˜'ë¼ê³  ë¶€íƒí•œë‹¤",
            outcome: "ê³µí†µ ì¹œêµ¬ê°€ ë§ì„ ì „í–ˆë‹¤. í•˜ì§€ë§Œ ì¹œêµ¬ê°€ 'ë’¤ì—ì„œ ê·¸ëŸ° ì‹ìœ¼ë¡œ?'ë¼ë©° ê¸°ë¶„ ë‚˜ë¹ í–ˆë‹¤.",
            principle: "ê°„ì ‘ ì†Œí†µì˜ ë¦¬ìŠ¤í¬",
            principleDesc: "ì œ3ìë¥¼ í†µí•œ ì†Œí†µì€ ë©”ì‹œì§€ê°€ ì™œê³¡ë˜ê³ , ë’¤ì—ì„œ í—˜ë‹´í•œë‹¤ëŠ” ì¸ìƒì„ ì¤€ë‹¤.",
            evaluation: "negative",
            evalText: "ê°„ì ‘ ì†Œí†µì€ ëŒ€ë¶€ë¶„ ì—­íš¨ê³¼ë¥¼ ë‚¸ë‹¤. ì§ì ‘ ë§í•˜ëŠ” ê²Œ ë‚«ë‹¤.",
            nextStage: "stage3_indirect"
          }
        ]
      },
      
      // Stage 3ë“¤
      {
        id: "stage3_fight",
        context: "ê°ì •ì‹¸ì›€ì´ ëë‹¤. ì„œë¡œ 'ë„¤ê°€ ì˜ëª»' 'ì•„ë‹ˆ ë„¤ê°€ ì˜ëª»'ì„ ë°˜ë³µ ì¤‘ì´ë‹¤.",
        situation: "ì´ëŒ€ë¡œ ê°€ë©´ ì¹œêµ¬ë„ ëˆë„ ë‹¤ ìƒëŠ”ë‹¤. ì–´ë–»ê²Œ ìˆ˜ìŠµí• ê¹Œ?",
        choices: [
          {
            text: "'ê·¸ë˜, ì‹¸ìš°ì§€ ë§ì. ëˆì€... ëë‹¤. ê·¸ëƒ¥ ì¹œêµ¬ë¡œ ì§€ë‚´ì'",
            outcome: "ì¹œêµ¬ê°€ '...ì§„ì§œ? ë¯¸ì•ˆí•´'ë¼ë©° í™”í•´í–ˆë‹¤. í•˜ì§€ë§Œ 30ë§Œì›ì€ ê³µì¤‘ìœ¼ë¡œ ì‚¬ë¼ì¡Œë‹¤. ê·¸ë¦¬ê³  ë§ˆìŒ í•œì¼ ì´ ì°ì°í•˜ë‹¤.",
            principle: "ë§¤ëª°ë¹„ìš©ì˜ ì†ì ˆ",
            principleDesc: "ì´ë¯¸ ìƒì€ ê²ƒ(ë§¤ëª°ë¹„ìš©)ì— ì§‘ì°©í•˜ë©´ ë” í° ì†í•´ë¥¼ ë³¸ë‹¤. í•˜ì§€ë§Œ 'ê·¸ëƒ¥ í¬ê¸°'ëŠ” ìê¸°í•©ë¦¬í™”ì¼ ìˆ˜ ìˆë‹¤.",
            evaluation: "neutral",
            evalText: "ê´€ê³„ëŠ” ì§€ì¼°ì§€ë§Œ, ì†ìœ¼ë¡œ í›„íšŒê°€ ë‚¨ì„ ìˆ˜ ìˆë‹¤.",
            nextStage: "end"
          },
          {
            text: "'ê°ì •ì€ ë‚˜ì¤‘ì— í’€ê³ , ëˆ ë¬¸ì œë§Œ ê¹”ë”í•˜ê²Œ ì •ë¦¬í•˜ì'",
            outcome: "ì¹œêµ¬ê°€ '...ê·¸ë˜ ì•Œê² ì–´. ë‹¤ìŒ ë‹¬ 15ì¼ê¹Œì§€ëŠ” ê¼­ ì¤„ê²Œ'ë¼ë©° êµ¬ì²´ì ì¸ ë‚ ì§œë¥¼ ì¡ì•˜ë‹¤.",
            principle: "ê°ì •ê³¼ ë¬¸ì œì˜ ë¶„ë¦¬",
            principleDesc: "ê°ì • ë¬¸ì œì™€ ì‹¤ì§ˆì  ë¬¸ì œë¥¼ ë¶„ë¦¬í•œë‹¤. í•˜ë‚˜ì”© í•´ê²°í•˜ë©´ ë‘˜ ë‹¤ í•´ê²°í•  ìˆ˜ ìˆë‹¤.",
            evaluation: "positive",
            evalText: "í˜„ëª…í•˜ë‹¤. ê°ì •ê³¼ ë¬¸ì œë¥¼ ë¶„ë¦¬í•´ì„œ ì‹¤ì§ˆì  ì§„ì „ì„ ë§Œë“¤ì—ˆë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_recover",
        context: "ì¹œêµ¬ê°€ 'ì´ë²ˆ ë‹¬ì—ëŠ” ê¼­'ì´ë¼ê³  í–ˆë‹¤. í•˜ì§€ë§Œ ì˜ˆì „ì—ë„ ê°™ì€ ë§ì„ ë“¤ì—ˆë‹¤.",
        situation: "ì´ë²ˆì—ëŠ” ì–´ë–»ê²Œ ë‹¤ë¥´ê²Œ í•  ìˆ˜ ìˆì„ê¹Œ?",
        choices: [
          {
            text: "'ê³ ë§ˆì›Œ. ê·¼ë° ì •í™•íˆ ë©°ì¹ ê¹Œì§€ ê°€ëŠ¥í•´?'ë¼ê³  êµ¬ì²´ì  ë‚ ì§œë¥¼ ìš”ì²­í•œë‹¤",
            outcome: "ì¹œêµ¬ê°€ 'ìŒ... 25ì¼?'ì´ë¼ê³  ë‹µí•œë‹¤. 25ì¼ì´ ëì„ ë•Œ ë‹¤ì‹œ ë¬¼ì–´ë³¼ ëª…ë¶„ì´ ìƒê²¼ë‹¤.",
            principle: "êµ¬ì²´ì  ì•½ì†",
            principleDesc: "'ì´ë²ˆ ë‹¬'ë³´ë‹¤ '25ì¼'ì´ ëª…í™•í•˜ë‹¤. êµ¬ì²´ì ì¸ ì•½ì†ì€ ì–´ê¸°ê¸° ì–´ë µê³ , ì–´ê²¼ì„ ë•Œ ì§€ì í•˜ê¸°ë„ ì‰½ë‹¤.",
            evaluation: "positive",
            evalText: "ì¢‹ì€ ì „ëµì´ë‹¤. ëª¨í˜¸í•œ ì•½ì†ì„ êµ¬ì²´ì ìœ¼ë¡œ ë°”ê¿¨ë‹¤.",
            nextStage: "end"
          },
          {
            text: "'ì•Œê² ì–´ ã…ã…'ë¼ê³  í•˜ê³  ê¸°ë‹¤ë¦°ë‹¤",
            outcome: "ì›”ë§ì´ ì§€ë‚¬ë‹¤. ì¹œêµ¬ì—ê²Œì„œ ì—°ë½ì´ ì—†ë‹¤. ë˜ ê°™ì€ ìƒí™©ì´ ë°˜ë³µëœë‹¤.",
            principle: "í•™ìŠµëœ ë¬´ë ¥ê°",
            principleDesc: "ë°˜ë³µë˜ëŠ” ì‹¤íŒ¨ë¥¼ ê²½í—˜í•˜ë©´ 'ì–´ì°¨í”¼ ì•ˆ ë  ê²ƒ'ì´ë¼ëŠ” ë¬´ë ¥ê°ì´ ìƒê¸´ë‹¤. ë‹¤ë¥¸ ì‹œë„ë¥¼ í•˜ì§€ ì•Šê²Œ ëœë‹¤.",
            evaluation: "negative",
            evalText: "ê°™ì€ ì‹¤ìˆ˜ë¥¼ ë°˜ë³µí–ˆë‹¤. ì´ë²ˆì—ë„ íì§€ë¶€ì§€ë  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_doormat",
        context: "ê´€ê³„ëŠ” ê´œì°®ì•„ì¡Œì§€ë§Œ, ëˆì€ ì—¬ì „íˆ ë°›ì§€ ëª»í–ˆë‹¤. ì¹œêµ¬ëŠ” ëˆ ì–˜ê¸°ë¥¼ êº¼ë‚´ì§€ ì•ŠëŠ”ë‹¤.",
        situation: "ì´ì œ ì–´ë–»ê²Œ í• ê¹Œ?",
        choices: [
          {
            text: "ë‹¤ì‹œ í•œ ë²ˆ ì •ì¤‘í•˜ê²Œ ìš”ì²­í•œë‹¤. 'ë¯¸ì•ˆí•œë°, ëˆ ì–˜ê¸° ë‹¤ì‹œ í•´ë„ ë ê¹Œ?'",
            outcome: "ì¹œêµ¬ê°€ 'ì•„ ê·¸ë˜... ë¯¸ì•ˆí•´. ë‹¤ìŒ ì£¼ê¹Œì§€ í•´ë³¼ê²Œ'ë¼ë©° ì§„ì§€í•˜ê²Œ ë°›ì•„ë“¤ì¸ë‹¤.",
            principle: "ì§€ì†ì  ìš”ì²­",
            principleDesc: "í•œ ë²ˆ ì–‘ë³´í–ˆë‹¤ê³  ê¶Œë¦¬ê°€ ì‚¬ë¼ì§€ì§€ ì•ŠëŠ”ë‹¤. ì •ì¤‘í•˜ì§€ë§Œ ì§€ì†ì ìœ¼ë¡œ ìš”ì²­í•˜ë©´ ìƒëŒ€ë„ ìš°ì„ ìˆœìœ„ë¥¼ ì˜¬ë¦°ë‹¤.",
            evaluation: "positive",
            evalText: "í¬ê¸°í•˜ì§€ ì•Šê³  ë‹¤ì‹œ ìš”ì²­í–ˆë‹¤. ì¢‹ì€ ì„ íƒì´ë‹¤.",
            nextStage: "end"
          },
          {
            text: "ê·¸ëƒ¥ í¬ê¸°í•œë‹¤. 30ë§Œì›ìœ¼ë¡œ ì¹œêµ¬ ì¸ì„± ì•Œê²Œ ëë‹¤ê³  ìƒê°í•˜ê¸°ë¡œ",
            outcome: "ë§ˆìŒì´ í¸í•´ì¡Œë‹¤. í•˜ì§€ë§Œ ê·¸ ì¹œêµ¬ì™€ëŠ” ì´ì „ì²˜ëŸ¼ ì§€ë‚´ê¸° ì–´ë ¤ì›Œì¡Œë‹¤.",
            principle: "ìˆ˜ì—…ë£Œ",
            principleDesc: "ë•Œë¡œëŠ” 'ìˆ˜ì—…ë£Œ'ë¼ ìƒê°í•˜ê³  ë„˜ì–´ê°€ëŠ” ê²ƒë„ ë°©ë²•ì´ë‹¤. ë‹¨, ì´ ê²½í—˜ì„ í†µí•´ ë‹¤ìŒì—ëŠ” ë¹Œë ¤ì£¼ëŠ” ê¸°ì¤€ì„ ì„¸ìš°ì.",
            evaluation: "neutral",
            evalText: "ë§ˆìŒì€ í¸í•˜ì§€ë§Œ, ê´€ê³„ì— ê· ì—´ì´ ìƒê²¼ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_deadline",
        context: "ì¹œêµ¬ê°€ ë˜ 'ì¡°ê¸ˆë§Œ ë”'ë¼ê³  í–ˆë‹¤. ì´ì œëŠ” íŒ¨í„´ì´ ë³´ì¸ë‹¤.",
        situation: "ì´ íŒ¨í„´ì„ ì–´ë–»ê²Œ ëŠì„ê¹Œ?",
        choices: [
          {
            text: "'ê·¸ëŸ¼ ì •í™•íˆ ì–¸ì œ? ë‚ ì§œ ì •í•´ì¤˜'ë¼ê³  êµ¬ì²´ì ìœ¼ë¡œ ë¬»ëŠ”ë‹¤",
            outcome: "ì¹œêµ¬ê°€ 'ë‹¤ìŒ ì£¼ ê¸ˆìš”ì¼..?'ì´ë¼ê³  ë‹µí•œë‹¤. ë“œë””ì–´ êµ¬ì²´ì ì¸ ë‚ ì§œê°€ ë‚˜ì™”ë‹¤.",
            principle: "ë§ˆê°ì˜ í˜",
            principleDesc: "ë§ˆê°ì´ ì—†ìœ¼ë©´ ì¼ì€ ë¬´í•œíˆ ë¯¸ë¤„ì§„ë‹¤. êµ¬ì²´ì  ê¸°í•œì„ ì •í•˜ë©´ ìƒëŒ€ì˜ í–‰ë™ì„ ì´ëŒì–´ë‚¼ ìˆ˜ ìˆë‹¤.",
            evaluation: "positive",
            evalText: "ë§ˆê°ì„ ì„¤ì •í–ˆë‹¤. ì´ì œ ê·¸ ë‚ ì§œì— ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.",
            nextStage: "end"
          },
          {
            text: "'ì†”ì§íˆ ë§í•´ì¤˜. ê°šì„ ì˜í–¥ì´ ìˆì–´?'ë¼ê³  ì§ì ‘ì ìœ¼ë¡œ ë¬»ëŠ”ë‹¤",
            outcome: "ì¹œêµ¬ê°€ ì¹¨ë¬µí•˜ë‹¤ê°€ '...ìˆì–´. ê·¼ë° ì§„ì§œ ì§€ê¸ˆ ì–´ë ¤ì›Œì„œ'ë¼ë©° ì†”ì§í•´ì¡Œë‹¤.",
            principle: "ì§ì ‘ì  ì§ˆë¬¸",
            principleDesc: "í•µì‹¬ì„ ì§ì ‘ ë¬¼ìœ¼ë©´ ìƒëŒ€ë„ í•µì‹¬ìœ¼ë¡œ ë‹µí•œë‹¤. ëŒë ¤ ë§í•˜ëŠ” ê²ƒë³´ë‹¤ íš¨ê³¼ì ì¼ ë•Œê°€ ìˆë‹¤.",
            evaluation: "positive",
            evalText: "ì§ì ‘ì ìœ¼ë¡œ ë¬¼ìœ¼ë‹ˆ ì§ì ‘ì ì¸ ë‹µì´ ì™”ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_partial",
        context: "10ë§Œì›ì„ ë°›ì•˜ë‹¤. ì•„ì§ 20ë§Œì›ì´ ë‚¨ì•˜ì§€ë§Œ, ì¼ë‹¨ ì›€ì§ì´ê¸° ì‹œì‘í–ˆë‹¤.",
        situation: "ë‚˜ë¨¸ì§€ 20ë§Œì›ì€ ì–´ë–»ê²Œ ë°›ì„ê¹Œ?",
        choices: [
          {
            text: "'ê³ ë§ˆì›Œ! ë‚˜ë¨¸ì§€ë„ ì´ëŸ° ì‹ìœ¼ë¡œ ë‚˜ëˆ ì„œ ì¤˜ë„ ë¼'ë¼ê³  ë§í•œë‹¤",
            outcome: "ì¹œêµ¬ê°€ 'ì‘ ê·¸ëŸ´ê²Œ. ë‹¤ìŒ ë‹¬ì— 10ë§Œì› ë” ë³´ë‚¼ê²Œ'ë¼ê³  í•œë‹¤. 3ê°œì›”ì— ê±¸ì³ ì „ì•¡ì„ íšŒìˆ˜í–ˆë‹¤.",
            principle: "ì„±ê³µ ê²½í—˜ì˜ ê°•í™”",
            principleDesc: "ì‘ì€ ì„±ê³µì€ ë‹¤ìŒ í–‰ë™ì˜ ë™ê¸°ê°€ ëœë‹¤. 'í•´ë´¤ë”ë‹ˆ ë˜ë„¤'ë¼ëŠ” ê²½í—˜ì´ ìŒ“ì¸ë‹¤.",
            evaluation: "positive",
            evalText: "ì™„ë²½í•œ ì „ëµ! ì‘ê²Œ ì‹œì‘í•´ì„œ ê²°êµ­ ì „ì•¡ì„ ë°›ì•˜ë‹¤.",
            nextStage: "end"
          },
          {
            text: "'ì‘ ê³ ë§ˆì›Œ~'í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì•Œì•„ì„œ ì£¼ê² ì§€ ê¸°ë‹¤ë¦°ë‹¤",
            outcome: "í•œ ë‹¬ì´ ì§€ë‚¬ì§€ë§Œ ì¶”ê°€ ì…ê¸ˆì´ ì—†ë‹¤. 10ë§Œì›ìœ¼ë¡œ ëë‚  ê²ƒ ê°™ë‹¤.",
            principle: "ë¶ˆì™„ì „í•œ ë§ˆë¬´ë¦¬",
            principleDesc: "ë§ˆë¬´ë¦¬ë¥¼ ì§“ì§€ ì•Šìœ¼ë©´ ì¼ì€ ì¤‘ê°„ì—ì„œ ë©ˆì¶˜ë‹¤. ëê¹Œì§€ ê´€ë¦¬ê°€ í•„ìš”í•˜ë‹¤.",
            evaluation: "neutral",
            evalText: "10ë§Œì›ì€ ë°›ì•˜ì§€ë§Œ, 20ë§Œì›ì€ íì§€ë¶€ì§€ë  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_empathy",
        context: "ì¹œêµ¬ì˜ ì‚¬ì •ì„ ë“¤ì—ˆë‹¤. íšŒì‚¬ì—ì„œ ê¶Œê³ ì‚¬ì§ì„ ë°›ì•˜ê³ , ì‹¤ì—…ê¸‰ì—¬ë„ ëŠ¦ì–´ì§€ê³  ìˆë‹¤ê³  í•œë‹¤.",
        situation: "ì§„ì§œ ì–´ë ¤ìš´ ìƒí™©ì´ì—ˆë‹¤. ì–´ë–»ê²Œ í• ê¹Œ?",
        choices: [
          {
            text: "'í˜ë“¤ì—ˆê² ë‹¤. ëˆì€ í˜•í¸ ë‚˜ì•„ì§€ë©´ ì²œì²œíˆ ì¤˜. ëŒ€ì‹  ì–´ëŠ ì •ë„ ë  ê²ƒ ê°™ì•„?'",
            outcome: "ì¹œêµ¬ê°€ 'ê³ ë§ˆì›Œ ì§„ì§œ... ì‹¤ì—…ê¸‰ì—¬ ë‚˜ì˜¤ë©´ ë°”ë¡œ ì¤„ê²Œ. ì•„ë§ˆ 2ë‹¬ ë’¤?'ë¼ë©° ê°ì‚¬í•´í•œë‹¤.",
            principle: "ì¡°ê±´ë¶€ ê´€ìš©",
            principleDesc: "ë¬´ì¡°ê±´ ë´ì£¼ëŠ” ê²Œ ì•„ë‹ˆë¼ 'ì–¸ì œ'ë¼ëŠ” ì¡°ê±´ì„ ë‹¨ë‹¤. ê´€ê³„ë„ ì§€í‚¤ê³ , ì•½ì†ë„ ë°›ëŠ”ë‹¤.",
            evaluation: "positive",
            evalText: "ìƒëŒ€ì˜ ìƒí™©ì„ ì´í•´í•˜ë©´ì„œë„ ì•½ì†ì„ ë°›ì•„ëƒˆë‹¤. ìµœì„ ì˜ ì„ íƒì´ë‹¤.",
            nextStage: "end"
          },
          {
            text: "'ê·¸ë˜ë„ 30ë§Œì›ì€ ë‚˜í•œí…Œë„ í° ëˆì´ì•¼. ì¡°ê¸ˆì”©ì´ë¼ë„...'",
            outcome: "ì¹œêµ¬ê°€ '...ê·¸ë˜ ì•Œê² ì–´. ë‹¤ìŒ ë‹¬ì— 5ë§Œì›ì´ë¼ë„ ë³´ë‚¼ê²Œ'ë¼ë©° ìˆ˜ë½í•œë‹¤.",
            principle: "ìê¸° ì£¼ì¥",
            principleDesc: "ìƒëŒ€ ìƒí™©ì„ ì´í•´í•˜ë˜, ìì‹ ì˜ ì…ì¥ë„ ë§í•´ì•¼ í•œë‹¤. ì¼ë°©ì  ì–‘ë³´ëŠ” ê´€ê³„ì˜ ê· í˜•ì„ ë¬´ë„ˆëœ¨ë¦°ë‹¤.",
            evaluation: "positive",
            evalText: "ê³µê°í•˜ë©´ì„œë„ ìê¸° ì…ì¥ì„ ë§í–ˆë‹¤. ê· í˜• ì¡íŒ ëŒ€í™”ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_faceto",
        context: "ì¹œêµ¬ê°€ ì§ì ‘ ë§Œë‚˜ë‹ˆ ë” ë¯¸ì•ˆí•´í•˜ë©° 'ì§„ì§œ ë¯¸ì•ˆí•´'ë¥¼ ë°˜ë³µí•œë‹¤.",
        situation: "ì–´ë–»ê²Œ ë§ˆë¬´ë¦¬í• ê¹Œ?",
        choices: [
          {
            text: "'ê´œì°®ì•„. ê·¸ëŸ¼ ìš°ë¦¬ êµ¬ì²´ì ìœ¼ë¡œ ì •í•˜ì. ì–¸ì œê¹Œì§€ ì–¼ë§ˆ?'",
            outcome: "ì¹œêµ¬ê°€ 'ë‹¤ìŒ ë‹¬ 15ì¼ì— 15ë§Œì›, ê·¸ ë‹¤ìŒ ë‹¬ì— 15ë§Œì› ì¤„ê²Œ'ë¼ë©° êµ¬ì²´ì ì¸ ê³„íšì„ ì„¸ì› ë‹¤. ì‹¤ì œë¡œ ì§€ì¼œì¡Œë‹¤.",
            principle: "êµ¬ì²´ì  ì‹¤í–‰ ê³„íš",
            principleDesc: "ì˜ì§€ë§Œìœ¼ë¡œëŠ” ì‹¤í–‰ì´ ì•ˆ ëœë‹¤. êµ¬ì²´ì ì¸ ë‚ ì§œì™€ ê¸ˆì•¡ì´ ìˆì–´ì•¼ ì§€í‚¬ ìˆ˜ ìˆë‹¤.",
            evaluation: "positive",
            evalText: "ì™„ë²½í•˜ë‹¤! êµ¬ì²´ì ì¸ ê³„íšì„ ì„¸ìš°ê³  ì‹¤í–‰ê¹Œì§€ ì´ì–´ì¡Œë‹¤.",
            nextStage: "end"
          },
          {
            text: "'ì•Œê² ì–´, ì—¬ìœ  ë  ë•Œ ì¤˜'ë¼ê³  í•˜ë©° ë„˜ì–´ê°„ë‹¤",
            outcome: "ì¹œêµ¬ê°€ ê³ ë§ˆì›Œí–ˆë‹¤. 3ê°œì›” í›„, ê°‘ìê¸° 30ë§Œì›ì´ ë“¤ì–´ì™”ë‹¤. ë†€ëì§€ë§Œ ê¸°ë»¤ë‹¤.",
            principle: "ì‹ ë¢°ì˜ íšŒë³µ",
            principleDesc: "ì§ì ‘ ë§Œë‚˜ì„œ ì§„ì‹¬ì„ í™•ì¸í•˜ë©´, ìƒëŒ€ë„ ì±…ì„ê°ì„ ëŠë‚€ë‹¤. ë•Œë¡œëŠ” ë¯¿ì–´ì£¼ëŠ” ê²ƒë„ ë°©ë²•ì´ë‹¤.",
            evaluation: "positive",
            evalText: "ì‹ ë¢°ë¥¼ ë³´ì—¬ì¤¬ë”ë‹ˆ ì¹œêµ¬ê°€ ê²°êµ­ ê°šì•˜ë‹¤. ì¢‹ì€ ê²°ë§ì´ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_need",
        context: "ë„¤ ìƒí™©ì„ ì•Œê²Œ ëœ ì¹œêµ¬ê°€ 'ë¯¸ì•ˆ, ëª°ëì–´'ë¼ë©° ì§„ì§€í•´ì¡Œë‹¤.",
        situation: "ë¶„ìœ„ê¸°ê°€ ë‹¬ë¼ì¡Œë‹¤. ì–´ë–»ê²Œ ë§ˆë¬´ë¦¬í• ê¹Œ?",
        choices: [
          {
            text: "'ê´œì°®ì•„, ê·¼ë° ì–¸ì œê¹Œì§€ ê°€ëŠ¥í• ê¹Œ?'",
            outcome: "ì¹œêµ¬ê°€ 'ì´ë²ˆ ì£¼ ì•ˆì—ëŠ” ê¼­ ë³´ë‚¼ê²Œ'ë¼ë©° ì•½ì†í•œë‹¤. ì‹¤ì œë¡œ 3ì¼ í›„ ì…ê¸ˆì´ ì™”ë‹¤.",
            principle: "ìƒí˜¸ ì´í•´ì˜ í˜",
            principleDesc: "ì„œë¡œì˜ ìƒí™©ì„ ì•Œë©´ í•´ê²°ì´ ì‰¬ì›Œì§„ë‹¤. ì¼ë°©ì  ìš”êµ¬ê°€ ì•„ë‹ˆë¼ ìƒí˜¸ ì´í•´ê°€ í˜‘ë ¥ì„ ì´ëˆë‹¤.",
            evaluation: "positive",
            evalText: "ë„¤ ìƒí™©ì„ ì•Œë¦¬ë‹ˆ ì¹œêµ¬ê°€ ìš°ì„ ìˆœìœ„ë¥¼ ì˜¬ë ¸ë‹¤. ë°”ë¡œ í•´ê²°ëë‹¤!",
            nextStage: "end"
          },
          {
            text: "'ê·¸ë˜ ì•Œì•˜ì–´. ê°€ëŠ¥í•  ë•Œ ë³´ë‚´ì¤˜'",
            outcome: "ì¼ì£¼ì¼ í›„ ì¹œêµ¬ê°€ ë¨¼ì € ì—°ë½í•´ì„œ 'ì˜¤ëŠ˜ ë³´ëƒˆì–´ ë¯¸ì•ˆí–ˆì–´'ë¼ê³  í•œë‹¤.",
            principle: "ìë°œì  ë™ê¸°",
            principleDesc: "ê°•ìš”ë³´ë‹¤ ìë°œì  ë™ê¸°ê°€ ê°•í•˜ë‹¤. ìƒëŒ€ê°€ ìŠ¤ìŠ¤ë¡œ ê²°ì •í•˜ê²Œ í•˜ë©´ ë” ì˜ ì§€í‚¨ë‹¤.",
            evaluation: "positive",
            evalText: "ì¹œêµ¬ê°€ ìŠ¤ìŠ¤ë¡œ ì›€ì§ì˜€ë‹¤. ì¢‹ì€ ê²°ë§ì´ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_indirect",
        context: "ì¹œêµ¬ê°€ ê¸°ë¶„ ë‚˜ë¹ í–ˆë‹¤. 'ì§ì ‘ ë§í•˜ì§€ ì™œ ê·¸ë˜'ë¼ë©° ì„œìš´í•´í•œë‹¤.",
        situation: "ê´€ê³„ê°€ í‹€ì–´ì§€ê³  ìˆë‹¤. ì–´ë–»ê²Œ ìˆ˜ìŠµí• ê¹Œ?",
        choices: [
          {
            text: "'ë¯¸ì•ˆ, ì§ì ‘ ë§í•˜ê¸° ì–´ë ¤ì›Œì„œ ê·¸ë¬ì–´. ì•ìœ¼ë¡œëŠ” ì§ì ‘ ì–˜ê¸°í• ê²Œ'",
            outcome: "ì¹œêµ¬ê°€ '...ì•Œê² ì–´. ë‚˜ë„ ë¯¸ì•ˆí•´. ëˆì€ ë‹¤ìŒ ì£¼ì— ì¤„ê²Œ'ë¼ë©° í’€ë ¸ë‹¤.",
            principle: "ì†”ì§í•œ ì¸ì •",
            principleDesc: "ì‹¤ìˆ˜ë¥¼ ì¸ì •í•˜ë©´ ìƒëŒ€ë„ ë§ˆìŒì´ ëˆ„ê·¸ëŸ¬ì§„ë‹¤. ë³€ëª…ë³´ë‹¤ ì†”ì§í•œ ì¸ì •ì´ ì‹ ë¢°ë¥¼ ìŒ“ëŠ”ë‹¤.",
            evaluation: "positive",
            evalText: "ì‹¤ìˆ˜ë¥¼ ì¸ì •í•˜ê³  ê´€ê³„ë¥¼ íšŒë³µí–ˆë‹¤.",
            nextStage: "end"
          },
          {
            text: "'ë‚´ê°€ ì™œ ë¯¸ì•ˆí•´ì•¼ í•´? ëˆ ì•ˆ ê°šì€ ê±´ ë„ˆì–ì•„'",
            outcome: "ì¹œêµ¬ê°€ 'ê·¸ë˜ ë‚´ê°€ ì˜ëª»í–ˆì§€. ê·¼ë° ë’¤ì—ì„œ ê·¸ëŸ¬ëŠ” ê²ƒë„ ì˜í•œ ê±°ì•¼?'ë¼ë©° ì‹¸ì›€ì´ ì»¤ì¡Œë‹¤.",
            principle: "ì •ë‹¹í™”ì˜ í•¨ì •",
            principleDesc: "ìê¸° í–‰ë™ì„ ì •ë‹¹í™”í•˜ë©´ ìƒëŒ€ë„ ì •ë‹¹í™”ë¡œ ë§ì„ ë‹¤. ëˆ„ê°€ ë” ì˜ëª»í–ˆë‚˜ ì‹¸ì›€ì€ ëì´ ì—†ë‹¤.",
            evaluation: "negative",
            evalText: "ê´€ê³„ê°€ ë” ë‚˜ë¹ ì¡Œë‹¤. ëˆë„ ë°›ê¸° ì–´ë ¤ì›Œì¡Œë‹¤.",
            nextStage: "end"
          }
        ]
      }
    ];

    let currentStageId = 1;
    let collectedPrinciples = [];
    let stageHistory = [];

    function getStageById(id) {
      return stages.find(s => s.id === id);
    }

    function init() {
      renderProgress();
      renderStage();
      
      document.getElementById('next-btn').addEventListener('click', nextStage);
      document.getElementById('restart-btn').addEventListener('click', restart);
      document.getElementById('native-share-btn').addEventListener('click', nativeShare);
      document.getElementById('copy-btn').addEventListener('click', copyLink);
      document.getElementById('other-toggle').addEventListener('click', toggleOtherChoices);
    }

    function toggleOtherChoices() {
      const content = document.getElementById('other-choices-content');
      const toggle = document.getElementById('other-toggle');
      content.classList.toggle('hidden');
      toggle.classList.toggle('open');
    }

    function renderProgress() {
      const totalStages = 3;
      const currentCount = stageHistory.length;
      
      const progressEl = document.getElementById('progress');
      progressEl.innerHTML = Array(totalStages).fill(0).map((_, idx) => {
        let className = 'progress-bar';
        if (idx < currentCount) className += ' completed';
        else if (idx === currentCount) className += ' current';
        return `<div class="${className}"></div>`;
      }).join('');
    }

    function renderStage() {
      const stage = getStageById(currentStageId);
      if (!stage) return;
      
      document.getElementById('stage-label').textContent = `Stage ${stageHistory.length + 1}`;
      document.getElementById('context').textContent = stage.context;
      document.getElementById('situation').textContent = stage.situation;
      
      const choicesEl = document.getElementById('choices');
      choicesEl.innerHTML = stage.choices.map((choice, idx) => `
        <button class="choice-btn" data-index="${idx}">${choice.text}</button>
      `).join('');
      
      choicesEl.querySelectorAll('.choice-btn').forEach(btn => {
        btn.addEventListener('click', () => handleChoice(parseInt(btn.dataset.index)));
      });
      
      document.getElementById('choices').classList.remove('hidden');
      document.getElementById('result-section').classList.remove('show');
    }

    function handleChoice(index) {
      const stage = getStageById(currentStageId);
      const choice = stage.choices[index];
      
      stageHistory.push({
        stageId: currentStageId,
        choiceIndex: index,
        principle: choice.principle
      });
      
      if (!collectedPrinciples.find(p => p.name === choice.principle)) {
        collectedPrinciples.push({
          name: choice.principle,
          desc: choice.principleDesc
        });
      }
      
      document.getElementById('choices').classList.add('hidden');
      document.getElementById('result-section').classList.add('show');
      
      document.getElementById('selected-text').textContent = choice.text;
      document.getElementById('outcome-text').textContent = choice.outcome;
      document.getElementById('principle-name').textContent = choice.principle;
      document.getElementById('principle-explanation').textContent = choice.principleDesc;
      
      const evalCard = document.getElementById('evaluation-card');
      const evalIcon = document.getElementById('evaluation-icon');
      const evalText = document.getElementById('evaluation-text');
      
      evalCard.className = 'evaluation-card ' + choice.evaluation;
      evalText.textContent = choice.evalText;
      
      if (choice.evaluation === 'positive') evalIcon.textContent = 'âœ“';
      else if (choice.evaluation === 'neutral') evalIcon.textContent = 'âš ï¸';
      else evalIcon.textContent = 'âœ—';
      
      const otherChoices = stage.choices.filter((_, i) => i !== index);
      const otherContent = document.getElementById('other-choices-content');
      otherContent.innerHTML = otherChoices.map(c => {
        let evalBadge = '';
        if (c.evaluation === 'positive') evalBadge = '<span class="eval-badge positive">âœ“ íš¨ê³¼ì </span>';
        else if (c.evaluation === 'neutral') evalBadge = '<span class="eval-badge neutral">âš ï¸ ìƒí™©ì— ë”°ë¼</span>';
        else evalBadge = '<span class="eval-badge negative">âœ— ë¦¬ìŠ¤í¬</span>';
        
        return `
          <div class="other-choice-card">
            <div class="other-choice-header">${evalBadge}</div>
            <div class="other-choice-text">${c.text}</div>
            <div class="other-choice-outcome">${c.outcome}</div>
            <div class="other-choice-eval">${c.evalText}</div>
            <div class="other-choice-principle"><strong>${c.principle}</strong>: ${c.principleDesc}</div>
          </div>
        `;
      }).join('');
      
      document.getElementById('other-choices-content').classList.add('hidden');
      document.getElementById('other-toggle').classList.remove('open');
      
      const nextBtn = document.getElementById('next-btn');
      if (choice.nextStage === 'end') {
        nextBtn.textContent = 'ê²°ê³¼ ë³´ê¸°';
      } else {
        nextBtn.textContent = 'ë‹¤ìŒ ìƒí™©';
      }
      
      currentStageId = choice.nextStage;
      renderProgress();
    }

    function nextStage() {
      if (currentStageId === 'end') {
        showFinalScreen();
      } else {
        renderStage();
      }
    }

    function showFinalScreen() {
      document.getElementById('game-screen').classList.add('hidden');
      document.getElementById('final-screen').classList.add('show');
      
      const principlesList = document.getElementById('principles-list');
      principlesList.innerHTML = collectedPrinciples.map(p => `
        <div class="principle-item">
          <div class="principle-item-icon">ğŸ’¡</div>
          <div class="principle-item-content">
            <div class="principle-item-name">${p.name}</div>
            <div class="principle-item-desc">${p.desc}</div>
          </div>
        </div>
      `).join('');
      
      saveProgress();
      showInstallButton();
    }

    function saveProgress() {
      let saved = localStorage.getItem(STORAGE_KEY);
      let profile;
      
      if (saved) {
        profile = JSON.parse(saved);
      } else {
        profile = { name: 'ìµëª… íƒí—˜ê°€', level: 1, exp: 0, completedSims: [], principles: [] };
      }
      
      if (!profile.completedSims) profile.completedSims = [];
      if (!profile.principles) profile.principles = [];
      
      const isFirstTime = !profile.completedSims.includes(SIM_ID);
      
      if (isFirstTime) {
        profile.completedSims.push(SIM_ID);
        profile.exp = (profile.exp || 0) + 30;
        
        const expNeeded = (profile.level || 1) * 100;
        while (profile.exp >= expNeeded) {
          profile.exp -= expNeeded;
          profile.level = (profile.level || 1) + 1;
        }
      }
      
      collectedPrinciples.forEach(p => {
        if (!profile.principles.find(existing => existing.name === p.name)) {
          profile.principles.push(p);
        }
      });
      
      localStorage.setItem(STORAGE_KEY, JSON.stringify(profile));
    }

    function getShareText() {
      return `ğŸ’° ì´í´ë¦½ìŠ¤ ë§ˆì¸ë“œë©

[ëˆ ì•ˆ ê°šëŠ” ì¹œêµ¬] í´ë¦¬ì–´!

ë°œê²¬í•œ ì›ì¹™ ${collectedPrinciples.length}ê°œ:
${collectedPrinciples.map(p => 'â€¢ ' + p.name).join('\n')}

ë‹¹ì‹ ì€ ëˆì„ ë°›ì„ ìˆ˜ ìˆì„ê¹Œìš”?`;
    }

    function nativeShare() {
      if (navigator.share) {
        navigator.share({
          title: 'ëˆ ì•ˆ ê°šëŠ” ì¹œêµ¬ - ì´í´ë¦½ìŠ¤ ë§ˆì¸ë“œë©',
          text: getShareText(),
          url: SITE_URL
        }).catch(() => {});
      } else {
        copyLink();
      }
    }

    function copyLink() {
      const text = getShareText() + '\n' + SITE_URL;
      const btn = document.getElementById('copy-btn');
      
      navigator.clipboard.writeText(text).then(() => {
        btn.classList.add('success');
        btn.innerHTML = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> ë³µì‚¬ ì™„ë£Œ!`;
        setTimeout(() => {
          btn.classList.remove('success');
          btn.innerHTML = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> ë§í¬ ë³µì‚¬`;
        }, 2000);
      });
    }

    function restart() {
      currentStageId = 1;
      collectedPrinciples = [];
      stageHistory = [];
      
      document.getElementById('final-screen').classList.remove('show');
      document.getElementById('game-screen').classList.remove('hidden');
      
      renderProgress();
      renderStage();
    }

    // PWA
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
    });

    function showInstallButton() {
      if (deferredPrompt && installBtn) {
        installBtn.classList.remove('hidden');
      }
    }

    installBtn.addEventListener('click', async () => {
      if (!deferredPrompt) return;
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      if (outcome === 'accepted') {
        installBtn.classList.add('hidden');
      }
      deferredPrompt = null;
    });

    window.addEventListener('appinstalled', () => {
      installBtn.classList.add('hidden');
      deferredPrompt = null;
    });

    init();
  </script>
</body>
</html>
