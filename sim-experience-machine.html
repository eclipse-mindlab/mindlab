<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê²½í—˜ ê¸°ê³„ - ì´í´ë¦½ìŠ¤ ë§ˆì¸ë“œë©</title>
  
  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#7c3aed">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #09090b;
      color: #fff;
      min-height: 100vh;
      padding: 24px;
      line-height: 1.6;
    }
    
    .container { max-width: 540px; margin: 0 auto; }
    
    .header { margin-bottom: 32px; }

    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #71717a;
      text-decoration: none;
      font-size: 14px;
      margin-bottom: 16px;
    }

    .back-btn:hover { color: #60a5fa; }

    .header-content { text-align: center; }
    .header-category { font-size: 12px; color: #60a5fa; margin-bottom: 8px; }
    .header h1 { font-size: 22px; color: #fff; margin-bottom: 4px; }
    .header p { font-size: 14px; color: #71717a; }
    
    .progress { display: flex; gap: 8px; margin-bottom: 24px; }
    
    .progress-bar {
      height: 4px;
      flex: 1;
      border-radius: 4px;
      background: #27272a;
      transition: background 0.3s;
    }
    
    .progress-bar.completed { background: #60a5fa; }
    .progress-bar.current { background: rgba(96, 165, 250, 0.5); }
    
    .scenario-card {
      background: #18181b;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
    }

    .stage-label {
      font-size: 11px;
      color: #71717a;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .context {
      font-size: 13px;
      color: #a1a1aa;
      margin-bottom: 12px;
      padding: 12px;
      background: #1f1f23;
      border-radius: 8px;
    }
    
    .situation { font-size: 17px; line-height: 1.8; }
    
    .choices { display: flex; flex-direction: column; gap: 12px; }
    
    .choice-btn {
      width: 100%;
      text-align: left;
      padding: 16px;
      background: #18181b;
      border: 1px solid #27272a;
      border-radius: 12px;
      color: #fff;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.2s;
      line-height: 1.6;
    }
    
    .choice-btn:hover {
      background: #27272a;
      border-color: #3f3f46;
    }
    
    .result-section { display: none; }
    .result-section.show { display: block; }
    
    .selected-choice {
      padding: 16px;
      background: #18181b;
      border: 2px solid #3f3f46;
      border-radius: 12px;
      margin-bottom: 16px;
    }
    
    .selected-header { font-size: 13px; color: #71717a; margin-bottom: 8px; }
    .selected-text { color: #d4d4d8; line-height: 1.6; }
    
    .outcome-card {
      padding: 16px;
      background: rgba(24, 24, 27, 0.5);
      border-radius: 12px;
      margin-bottom: 16px;
    }
    
    .outcome-label { font-size: 13px; color: #71717a; margin-bottom: 8px; }
    .outcome-text { color: #d4d4d8; line-height: 1.8; }
    
    .principle-card {
      padding: 20px;
      background: linear-gradient(135deg, rgba(96, 165, 250, 0.15), #18181b);
      border: 1px solid rgba(96, 165, 250, 0.3);
      border-radius: 12px;
      margin-bottom: 16px;
    }
    
    .principle-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .principle-icon { font-size: 20px; }
    .principle-label {
      font-size: 11px;
      color: #60a5fa;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .principle-name { color: #fff; font-weight: 600; font-size: 16px; margin-bottom: 8px; }
    .principle-explanation { color: #a1a1aa; line-height: 1.8; font-size: 14px; }

    .evaluation-card {
      display: flex;
      gap: 12px;
      padding: 14px 16px;
      border-radius: 12px;
      margin-bottom: 16px;
      align-items: flex-start;
    }

    .evaluation-card.insight {
      background: rgba(96, 165, 250, 0.1);
      border: 1px solid rgba(96, 165, 250, 0.3);
    }

    .evaluation-icon { font-size: 18px; flex-shrink: 0; }
    .evaluation-text { font-size: 14px; line-height: 1.7; color: #60a5fa; }

    .other-choices-section { margin-bottom: 16px; }

    .other-choices-toggle {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 12px;
      background: transparent;
      border: 1px solid #27272a;
      border-radius: 10px;
      color: #71717a;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .other-choices-toggle:hover {
      border-color: #3f3f46;
      color: #a1a1aa;
    }

    .other-choices-toggle.open {
      border-color: #3f3f46;
      background: #18181b;
    }

    .other-choices-toggle.open svg { transform: rotate(180deg); }

    .other-choices-content {
      margin-top: 12px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .other-choices-content.hidden { display: none; }

    .other-choice-card {
      background: #131316;
      border: 1px solid #1f1f23;
      border-radius: 12px;
      padding: 14px;
    }

    .other-choice-text { font-size: 14px; color: #a1a1aa; margin-bottom: 10px; line-height: 1.6; }

    .other-choice-outcome {
      font-size: 13px;
      color: #71717a;
      margin-bottom: 10px;
      padding: 10px;
      background: #18181b;
      border-radius: 8px;
      line-height: 1.6;
    }

    .other-choice-principle { font-size: 12px; color: #71717a; }
    .other-choice-principle strong { color: #60a5fa; }

    .next-btn {
      width: 100%;
      padding: 16px;
      background: #3b82f6;
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .next-btn:hover { background: #2563eb; }
    
    .final-screen { display: none; padding: 20px 0; }
    .final-screen.show { display: block; }

    .clear-card {
      background: linear-gradient(135deg, #1f1f23, #18181b);
      border: 1px solid #27272a;
      border-radius: 20px;
      padding: 32px 24px;
      margin-bottom: 24px;
      text-align: center;
    }

    .clear-icon { font-size: 56px; margin-bottom: 16px; }
    .clear-title { font-size: 24px; font-weight: 700; margin-bottom: 8px; }
    .clear-subtitle { font-size: 14px; color: #71717a; margin-bottom: 20px; }

    .clear-exp {
      display: inline-block;
      padding: 8px 16px;
      background: rgba(96, 165, 250, 0.2);
      border-radius: 20px;
      color: #60a5fa;
      font-weight: 600;
    }

    .principles-collected {
      background: #18181b;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 24px;
    }

    .principles-title { font-size: 14px; color: #71717a; margin-bottom: 16px; }

    .principle-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px;
      background: #1f1f23;
      border-radius: 10px;
      margin-bottom: 8px;
    }

    .principle-item:last-child { margin-bottom: 0; }
    .principle-item-icon { font-size: 20px; flex-shrink: 0; }
    .principle-item-content { flex: 1; }
    .principle-item-name { font-size: 14px; font-weight: 600; margin-bottom: 4px; }
    .principle-item-desc { font-size: 12px; color: #71717a; line-height: 1.5; }

    .share-section { margin-bottom: 24px; }
    .share-label { font-size: 14px; color: #71717a; margin-bottom: 12px; text-align: center; }
    .share-buttons { display: flex; gap: 10px; justify-content: center; }
    
    .share-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 12px 18px;
      background: #27272a;
      border: 1px solid #3f3f46;
      border-radius: 10px;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .share-btn:hover { background: #3f3f46; }
    .share-btn.success { background: #166534; border-color: #22c55e; }

    .action-buttons { display: flex; flex-direction: column; gap: 10px; }
    
    .home-btn {
      width: 100%;
      padding: 16px;
      background: #3b82f6;
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      display: block;
      text-align: center;
    }

    .home-btn:hover { background: #2563eb; }

    .restart-btn {
      width: 100%;
      padding: 16px;
      background: transparent;
      border: 1px solid #3f3f46;
      border-radius: 12px;
      color: #a1a1aa;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .restart-btn:hover { background: #27272a; color: #fff; }

    .install-btn {
      width: 100%;
      margin-top: 8px;
      padding: 14px;
      background: linear-gradient(135deg, #7c3aed, #5b21b6);
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .install-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4);
    }

    .install-btn.hidden { display: none; }

    .promo-section {
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid #27272a;
    }

    .eclipse-section {
      text-align: center;
      margin-bottom: 24px;
    }
    
    .eclipse-section-title {
      font-size: 14px;
      color: #71717a;
      margin-bottom: 16px;
    }
    
    .youtube-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 14px 32px;
      background: #27272a;
      border: 1px solid #3f3f46;
      border-radius: 12px;
      color: #fff;
      font-size: 15px;
      font-weight: 500;
      text-decoration: none;
      transition: all 0.2s;
    }
    
    .youtube-btn:hover {
      background: #3f3f46;
      transform: translateY(-2px);
    }
    
    .youtube-btn svg { fill: #ff0000; }
    
    .books-section {
      text-align: center;
      padding-top: 24px;
      border-top: 1px solid #27272a;
    }
    
    .books-section-title {
      font-size: 14px;
      color: #71717a;
      margin-bottom: 20px;
    }
    
    .books-grid {
      display: flex;
      gap: 16px;
      justify-content: center;
    }
    
    .book-item {
      flex: 1;
      max-width: 140px;
      text-decoration: none;
      color: #fff;
      transition: all 0.2s;
    }
    
    .book-item:hover { transform: translateY(-4px); }
    
    .book-item img {
      width: 100%;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      margin-bottom: 10px;
    }
    
    .book-item-title { font-size: 13px; color: #a1a1aa; }

    .hidden { display: none !important; }

    .philosopher-quote {
      font-style: italic;
      color: #71717a;
      padding: 12px;
      border-left: 2px solid #60a5fa;
      margin-top: 12px;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <a href="index.html" class="back-btn">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        ëŒì•„ê°€ê¸°
      </a>
      <div class="header-content">
        <div class="header-category">ì² í•™ Â· ì‚¬ê³ ì‹¤í—˜</div>
        <h1>ê²½í—˜ ê¸°ê³„</h1>
        <p>ì™„ë²½í•œ í–‰ë³µì´ ë³´ì¥ëœë‹¤ë©´, ê°€ì§œ ì„¸ê³„ë¥¼ ì„ íƒí•  ìˆ˜ ìˆì„ê¹Œ?</p>
      </div>
    </div>
    
    <div class="progress" id="progress"></div>
    
    <div id="game-screen">
      <div class="scenario-card">
        <div class="stage-label" id="stage-label">Stage 1</div>
        <div class="context" id="context"></div>
        <div class="situation" id="situation"></div>
      </div>
      
      <div class="choices" id="choices"></div>
      
      <div class="result-section" id="result-section">
        <div class="selected-choice">
          <div class="selected-header">ë‹¹ì‹ ì˜ ì„ íƒ</div>
          <div class="selected-text" id="selected-text"></div>
        </div>
        
        <div class="outcome-card">
          <div class="outcome-label">ì´ ì„ íƒì´ ì˜ë¯¸í•˜ëŠ” ê²ƒ</div>
          <div class="outcome-text" id="outcome-text"></div>
        </div>
        
        <div class="principle-card">
          <div class="principle-header">
            <span class="principle-icon">ğŸ’­</span>
            <span class="principle-label">ë°œê²¬í•œ ì² í•™ì  ì›ì¹™</span>
          </div>
          <div class="principle-name" id="principle-name"></div>
          <div class="principle-explanation" id="principle-explanation"></div>
        </div>

        <div class="evaluation-card insight">
          <div class="evaluation-icon" id="evaluation-icon">ğŸ”®</div>
          <div class="evaluation-text" id="evaluation-text"></div>
        </div>

        <div class="other-choices-section">
          <button class="other-choices-toggle" id="other-toggle">
            <span>ë‹¤ë¥¸ ê´€ì ì€?</span>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </button>
          <div class="other-choices-content hidden" id="other-choices-content"></div>
        </div>
        
        <button class="next-btn" id="next-btn">ë‹¤ìŒ ì§ˆë¬¸</button>
      </div>
    </div>
    
    <div class="final-screen" id="final-screen">
      <div class="clear-card">
        <div class="clear-icon">ğŸ§ </div>
        <div class="clear-title">ì‚¬ê³ ì‹¤í—˜ ì™„ë£Œ!</div>
        <div class="clear-subtitle">ê²½í—˜ ê¸°ê³„ ë”œë ˆë§ˆë¥¼ íƒí—˜í–ˆìŠµë‹ˆë‹¤</div>
        <div class="clear-exp">+30 EXP íšë“!</div>
      </div>

      <div class="principles-collected">
        <div class="principles-title">ğŸ’­ ë°œê²¬í•œ ì² í•™ì  ì›ì¹™ë“¤</div>
        <div id="principles-list"></div>
      </div>

      <div class="share-section">
        <div class="share-label">ì¹œêµ¬ì—ê²Œ ê³µìœ í•˜ê¸°</div>
        <div class="share-buttons">
          <button class="share-btn" id="native-share-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
              <polyline points="16 6 12 2 8 6"/>
              <line x1="12" y1="2" x2="12" y2="15"/>
            </svg>
            ê³µìœ í•˜ê¸°
          </button>
          <button class="share-btn" id="copy-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
            ë§í¬ ë³µì‚¬
          </button>
        </div>
      </div>

      <div class="action-buttons">
        <a href="index.html" class="home-btn">íƒí—˜ ì§€ë„ë¡œ ëŒì•„ê°€ê¸°</a>
        <button class="restart-btn" id="restart-btn">ë‹¤ì‹œ íƒí—˜í•˜ê¸°</button>
        <button class="install-btn hidden" id="installBtn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          ì•±ìœ¼ë¡œ ì„¤ì¹˜í•˜ê³  ê³„ì† íƒí—˜í•˜ê¸°
        </button>
      </div>

      <div class="promo-section">
        <div class="eclipse-section">
          <div class="eclipse-section-title">ì´í´ë¦½ìŠ¤ ë” ì•Œì•„ë³´ê¸°</div>
          <a href="https://www.youtube.com/@Eclipse-g4e" target="_blank" class="youtube-btn">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814z"/>
              <path fill="#fff" d="M9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
            </svg>
            ìœ íŠœë¸Œ ì±„ë„
          </a>
        </div>

        <div class="books-section">
          <div class="books-section-title">ì´í´ë¦½ìŠ¤ì˜ ì±…</div>
          <div class="books-grid">
            <a href="https://product.kyobobook.co.kr/detail/S000214938953" target="_blank" class="book-item">
              <img src="book-philosophy.png" alt="í›”ì¹œ ì² í•™ í¸">
              <div class="book-item-title">í›”ì¹œ ì² í•™ í¸</div>
            </a>
            <a href="https://product.kyobobook.co.kr/detail/S000214938954" target="_blank" class="book-item">
              <img src="book-psychology.png" alt="í›”ì¹œ ì‹¬ë¦¬í•™ í¸">
              <div class="book-item-title">í›”ì¹œ ì‹¬ë¦¬í•™ í¸</div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const SITE_URL = 'https://eclipse-mindlab.github.io/mindlab/';
    const STORAGE_KEY = 'eclipse_mindlab_profile';
    const SIM_ID = 'experience_machine';

    const stages = [
      {
        id: 1,
        context: "ë¡œë²„íŠ¸ ë…¸ì§ì˜ 'ê²½í—˜ ê¸°ê³„' ì‚¬ê³ ì‹¤í—˜. ë‹¹ì‹  ì•ì— ê¸°ê³„ê°€ ìˆë‹¤. ì´ ê¸°ê³„ì— ë“¤ì–´ê°€ë©´ ì›í•˜ëŠ” ëª¨ë“  ê²½í—˜ì„ ì™„ë²½í•˜ê²Œ ì‹œë®¬ë ˆì´ì…˜í•´ì¤€ë‹¤. ì¾Œë½, ì„±ê³µ, ì‚¬ë‘... ë¬´ì—‡ì´ë“ . ë‡Œê°€ ëŠë¼ëŠ” ê²½í—˜ì€ í˜„ì‹¤ê³¼ êµ¬ë¶„ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.",
        situation: "ê¸°ê³„ ì•ˆì—ì„œ ë‹¹ì‹ ì€ ë² ìŠ¤íŠ¸ì…€ëŸ¬ ì‘ê°€ê°€ ë  ìˆ˜ë„, ì„¸ê³„ ì—¬í–‰ì„ í•  ìˆ˜ë„, ì™„ë²½í•œ ì‚¬ë‘ì„ í•  ìˆ˜ë„ ìˆë‹¤. ë‹¨, í•œ ë²ˆ ë“¤ì–´ê°€ë©´ í‰ìƒ ë‚˜ì˜¬ ìˆ˜ ì—†ê³ , ê·¸ê²ƒì´ ê°€ì§œë¼ëŠ” ì‚¬ì‹¤ë„ ìŠê²Œ ëœë‹¤. ë“¤ì–´ê°€ê² ëŠ”ê°€?",
        choices: [
          {
            text: "ë“¤ì–´ê°„ë‹¤. ê²°êµ­ ì¤‘ìš”í•œ ê±´ ë‚´ê°€ ëŠë¼ëŠ” í–‰ë³µ ì•„ë‹Œê°€?",
            outcome: "ë‹¹ì‹ ì€ ì¾Œë½ì£¼ì˜(Hedonism)ì˜ ì…ì¥ì„ ì„ íƒí–ˆë‹¤. ë²¤ë‹´ì´ ë§í–ˆë“¯, 'ì¾Œë½ì˜ ì–‘ì´ ê°™ë‹¤ë©´ í•€ë³¼ì´ë‚˜ ì‹œë§Œí¼ì´ë‚˜ ì¢‹ë‹¤'. ê²½í—˜ ìì²´ê°€ ê°€ì¹˜ë¼ë©´, ê·¸ê²ƒì´ ì§„ì§œë“  ê°€ì§œë“  ìƒê´€ì—†ë‹¤.",
            principle: "ì¾Œë½ì£¼ì˜",
            principleDesc: "ê²½í—˜ ìì²´ê°€ ê°€ì¹˜ë¼ë©´, ê·¸ ê²½í—˜ì´ ì–´ë””ì„œ ì˜¤ë“  ì¤‘ìš”í•˜ì§€ ì•Šë‹¤ëŠ” ì…ì¥.",
            evaluation: "ì´ ì„ íƒì€ 'ê²°ê³¼'ê°€ 'ê³¼ì •'ë³´ë‹¤ ì¤‘ìš”í•˜ë‹¤ëŠ” ê´€ì ì„ ë°˜ì˜í•œë‹¤.",
            nextStage: "stage2_enter"
          },
          {
            text: "ë“¤ì–´ê°€ì§€ ì•ŠëŠ”ë‹¤. ê°€ì§œ í–‰ë³µì€ ì§„ì§œ í–‰ë³µì´ ì•„ë‹ˆë‹¤.",
            outcome: "ë‹¹ì‹ ì€ ì§„ì •ì„±(Authenticity)ì„ ì„ íƒí–ˆë‹¤. ì‚¬ë¥´íŠ¸ë¥´ê°€ ë§í•œ 'ì‹¤ì¡´'ì²˜ëŸ¼, ë‚´ê°€ ì§ì ‘ ì„ íƒí•˜ê³  ì±…ì„ì§€ëŠ” ì‚¶ë§Œì´ ì˜ë¯¸ê°€ ìˆë‹¤. ì‹œë®¬ë ˆì´ì…˜ëœ ì„±ê³µì€ ë‚´ê°€ ìŸì·¨í•œ ê²ƒì´ ì•„ë‹ˆë‹¤.",
            principle: "ì§„ì •ì„±",
            principleDesc: "ê²½í—˜ì˜ ì¶œì²˜ê°€ ì¤‘ìš”í•˜ë‹¤. ìŠ¤ìŠ¤ë¡œ ë§Œë“¤ì–´ë‚¸ ê²ƒë§Œì´ ì§„ì§œ ê°€ì¹˜ë¥¼ ê°€ì§„ë‹¤.",
            evaluation: "ì´ ì„ íƒì€ 'ê³¼ì •'ì´ 'ê²°ê³¼'ë§Œí¼, í˜¹ì€ ë” ì¤‘ìš”í•˜ë‹¤ëŠ” ê´€ì ì„ ë°˜ì˜í•œë‹¤.",
            nextStage: "stage2_refuse"
          },
          {
            text: "ì ê¹, ë” ìƒê°í•´ë³´ê³  ì‹¶ë‹¤.",
            outcome: "í˜„ëª…í•œ ì„ íƒì´ë‹¤. ì´ ë”œë ˆë§ˆëŠ” ë‹¨ìˆœí•˜ì§€ ì•Šë‹¤. ì¢€ ë” ê¹Šì´ ë“¤ì–´ê°€ë³´ì.",
            principle: "ì² í•™ì  ë³´ë¥˜",
            principleDesc: "ì¤‘ìš”í•œ ê²°ì •ì€ ì„œë‘ë¥´ì§€ ì•ŠëŠ”ë‹¤. ì¶©ë¶„íˆ ê³ ë¯¼í•˜ëŠ” ê²ƒë„ í•˜ë‚˜ì˜ ì…ì¥ì´ë‹¤.",
            evaluation: "ëŒ€ë¶€ë¶„ì˜ ì² í•™ìë“¤ë„ ì´ ë¬¸ì œì— ëŒ€í•´ ì˜¤ë˜ ê³ ë¯¼í–ˆë‹¤.",
            nextStage: "stage2_think"
          }
        ]
      },
      
      // ë“¤ì–´ê°€ê¸° ê²½ë¡œ
      {
        id: "stage2_enter",
        context: "ë‹¹ì‹ ì€ ì¾Œë½ì£¼ì˜ì  ì…ì¥ì„ ì„ íƒí–ˆë‹¤. ê·¸ëŸ°ë° í•œ ê°€ì§€ ì§ˆë¬¸ì´ ë” ìˆë‹¤.",
        situation: "ë§Œì•½ ê¸°ê³„ ì•ˆì—ì„œ 'ê°€ì¥ ì˜ë¯¸ ìˆëŠ” ì‚¶'ì„ ì‚´ ìˆ˜ ìˆë‹¤ë©´, ê·¸ê²ƒì€ ì§„ì§œ ì˜ë¯¸ ìˆëŠ” ì‚¶ì¸ê°€? ì•„ë‹ˆë©´ ê¸°ê³„ê°€ 'ì˜ë¯¸ ìˆë‹¤ê³  ëŠë¼ê²Œ' í•´ì£¼ëŠ” ê²ƒë¿ì¸ê°€?",
        choices: [
          {
            text: "ëŠë¼ëŠ” ê²ƒì´ ê³§ í˜„ì‹¤ì´ë‹¤. êµ¬ë¶„ì´ ë¬´ì˜ë¯¸í•˜ë‹¤.",
            outcome: "ë‹¹ì‹ ì€ ê¸‰ì§„ì  ì£¼ê´€ì£¼ì˜ì˜ ì…ì¥ì„ íƒí–ˆë‹¤. ì™¸ë¶€ ì„¸ê³„ëŠ” ê²°êµ­ ìš°ë¦¬ì˜ ê²½í—˜ì„ í†µí•´ì„œë§Œ ì¡´ì¬í•œë‹¤. ê²½í—˜ì´ í˜„ì‹¤ì„ êµ¬ì„±í•œë‹¤ë©´, 'ì§„ì§œ' í˜„ì‹¤ì´ë€ ê²ƒë„ ê²°êµ­ ê²½í—˜ì˜ ì§‘í•©ì¼ ë¿.",
            principle: "ê¸‰ì§„ì  ì£¼ê´€ì£¼ì˜",
            principleDesc: "í˜„ì‹¤ì€ ì£¼ê´€ì  ê²½í—˜ì˜ ì§‘í•©ì´ë‹¤. 'ê°ê´€ì  í˜„ì‹¤'ì´ë€ ê°œë… ìì²´ê°€ í™˜ìƒì¼ ìˆ˜ ìˆë‹¤.",
            evaluation: "ë²„í´ë¦¬ì˜ 'ì¡´ì¬í•˜ëŠ” ê²ƒì€ ì§€ê°ë˜ëŠ” ê²ƒ'ì´ë¼ëŠ” ëª…ì œì™€ ë§¥ì„ ê°™ì´ í•œë‹¤.",
            nextStage: "stage3_matrix"
          },
          {
            text: "ê·¸ë˜ë„ ë­”ê°€ ë‹¤ë¥´ë‹¤. ê¸°ê³„ê°€ ë§Œë“  ì˜ë¯¸ëŠ” ê°€ì§œë‹¤.",
            outcome: "í¥ë¯¸ë¡­ë‹¤. ì¾Œë½ì€ ë°›ì•„ë“¤ì´ë©´ì„œ ì˜ë¯¸ëŠ” ê±°ë¶€í•œë‹¤. ë‹¹ì‹ ì—ê²Œ ì¾Œë½ê³¼ ì˜ë¯¸ëŠ” ë‹¤ë¥¸ ê²ƒì¸ê°€?",
            principle: "ê°€ì¹˜ì˜ ìœ„ê³„",
            principleDesc: "ëª¨ë“  ê°€ì¹˜ê°€ ë™ë“±í•˜ì§€ ì•Šë‹¤. ì¾Œë½ë³´ë‹¤ ë†’ì€ ê°€ì¹˜ê°€ ìˆì„ ìˆ˜ ìˆë‹¤.",
            evaluation: "ë°€ì´ ë§í•œ 'ì§ˆì ìœ¼ë¡œ ë‹¤ë¥¸ ì¾Œë½'ì˜ ê°œë…ê³¼ ì—°ê²°ëœë‹¤.",
            nextStage: "stage3_meaning"
          }
        ]
      },
      
      // ê±°ë¶€ ê²½ë¡œ
      {
        id: "stage2_refuse",
        context: "ë‹¹ì‹ ì€ ì§„ì •ì„±ì„ ì„ íƒí–ˆë‹¤. í•˜ì§€ë§Œ í•œ ê°€ì§€ ë” ë¬¼ì–´ë³´ê² ë‹¤.",
        situation: "ìš°ë¦¬ê°€ 'ì§„ì§œ'ë¼ê³  ë¯¿ëŠ” í˜„ì‹¤ë„, ê²°êµ­ ë‡Œê°€ í•´ì„í•œ ì „ê¸° ì‹ í˜¸ì— ë¶ˆê³¼í•˜ë‹¤. ìƒ‰ê¹”ë„, ì†Œë¦¬ë„, ê°ì •ë„ ëª¨ë‘ ë‡Œê°€ ë§Œë“¤ì–´ë‚¸ ê²ƒì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ 'ì§„ì§œ í˜„ì‹¤'ì´ë¼ëŠ” ê²ƒì´ ê³¼ì—° ì¡´ì¬í•˜ëŠ”ê°€?",
        choices: [
          {
            text: "ê·¸ë˜ë„ ë‹¤ë¥´ë‹¤. ì™¸ë¶€ ì„¸ê³„ëŠ” ë¶„ëª… ì¡´ì¬í•œë‹¤.",
            outcome: "ë‹¹ì‹ ì€ ì‹¤ì¬ë¡ ì(Realist)ë‹¤. ìš°ë¦¬ì˜ ê²½í—˜ê³¼ ë…ë¦½ì ìœ¼ë¡œ ì¡´ì¬í•˜ëŠ” ì„¸ê³„ê°€ ìˆë‹¤ê³  ë¯¿ëŠ”ë‹¤. ê²½í—˜ ê¸°ê³„ëŠ” ê·¸ ì„¸ê³„ì™€ì˜ ì—°ê²°ì„ ëŠëŠ”ë‹¤.",
            principle: "ì‹¤ì¬ë¡ ",
            principleDesc: "ê²½í—˜ê³¼ ë…ë¦½ì ìœ¼ë¡œ ì¡´ì¬í•˜ëŠ” ê°ê´€ì  ì„¸ê³„ê°€ ìˆë‹¤.",
            evaluation: "ëŒ€ë¶€ë¶„ì˜ ì‚¬ëŒë“¤ì´ ì•”ë¬µì ìœ¼ë¡œ ê°€ì •í•˜ëŠ” ì…ì¥ì´ë‹¤.",
            nextStage: "stage3_real"
          },
          {
            text: "...ì‚¬ì‹¤ í™•ì‹ í•  ìˆ˜ ì—†ë‹¤.",
            outcome: "ì •ì§í•œ ë‹µë³€ì´ë‹¤. ë°ì¹´ë¥´íŠ¸ë„ ì´ ë¬¸ì œë¡œ ê³ ë¯¼í–ˆë‹¤. 'ë‚´ê°€ ì•„ëŠ” ëª¨ë“  ê²ƒì´ ì•…ë§ˆê°€ ë§Œë“  í™˜ì˜ì´ë¼ë©´?' ê·¸ê°€ ì°¾ì€ ë‹µì€ 'ë‚˜ëŠ” ìƒê°í•œë‹¤, ê³ ë¡œ ì¡´ì¬í•œë‹¤'ì˜€ë‹¤.",
            principle: "íšŒì˜ì£¼ì˜",
            principleDesc: "ìš°ë¦¬ê°€ ì•Œ ìˆ˜ ìˆëŠ” ê²ƒì˜ í•œê³„ë¥¼ ì¸ì •í•œë‹¤. í™•ì‹¤í•œ ê²ƒì€ ê±°ì˜ ì—†ë‹¤.",
            evaluation: "ì² í•™ì˜ ì¶œë°œì ì´ ë˜ëŠ” ê±´ì „í•œ íƒœë„ë‹¤.",
            nextStage: "stage3_doubt"
          }
        ]
      },
      
      // ë³´ë¥˜ ê²½ë¡œ
      {
        id: "stage2_think",
        context: "ì¢‹ë‹¤, ë” ê¹Šì´ ìƒê°í•´ë³´ì.",
        situation: "ì§€ê¸ˆ ë‹¹ì‹ ì´ ê²½í—˜í•˜ëŠ” ì´ ì„¸ê³„ê°€ ì´ë¯¸ 'ê²½í—˜ ê¸°ê³„' ì•ˆì´ ì•„ë‹ˆë¼ëŠ” ê²ƒì„ ì–´ë–»ê²Œ ì¦ëª…í•  ìˆ˜ ìˆëŠ”ê°€?",
        choices: [
          {
            text: "ì¦ëª…í•  ìˆ˜ ì—†ë‹¤. í•˜ì§€ë§Œ ê·¸ë˜ë„ ì˜ë¯¸ëŠ” ìˆë‹¤.",
            outcome: "ì‹¤ìš©ì£¼ì˜ì  ì ‘ê·¼ì´ë‹¤. ìœŒë¦¬ì—„ ì œì„ìŠ¤ëŠ” 'ì§„ë¦¬ë€ ë¯¿ì—ˆì„ ë•Œ ì¢‹ì€ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒ'ì´ë¼ í–ˆë‹¤. ì¦ëª…í•  ìˆ˜ ì—†ì–´ë„, í˜„ì‹¤ì´ë¼ê³  ë¯¿ê³  ì‚¬ëŠ” ê²ƒì´ ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¨ë‹¤.",
            principle: "ì‹¤ìš©ì£¼ì˜",
            principleDesc: "ì§„ë¦¬ì˜ ê°€ì¹˜ëŠ” ê·¸ê²ƒì´ ê°€ì ¸ì˜¤ëŠ” ê²°ê³¼ì— ìˆë‹¤.",
            evaluation: "ì² í•™ì„ ì‹¤ì œ ì‚¶ê³¼ ì—°ê²°í•˜ëŠ” ê´€ì ì´ë‹¤.",
            nextStage: "stage3_pragma"
          },
          {
            text: "ì¦ëª…í•  ìˆ˜ ì—†ë‹¤. ê·¸ë˜ì„œ ì•„ë¬´ê²ƒë„ í™•ì‹¤í•˜ì§€ ì•Šë‹¤.",
            outcome: "ë‹ˆíë¦¬ì¦˜ì˜ ê·¸ë¦¼ìê°€ ë³´ì¸ë‹¤. í•˜ì§€ë§Œ ë‹ˆì²´ëŠ” ë§í–ˆë‹¤. 'ì‹ ì´ ì£½ì—ˆë‹¤ë©´, ì¸ê°„ì´ ìŠ¤ìŠ¤ë¡œ ê°€ì¹˜ë¥¼ ì°½ì¡°í•´ì•¼ í•œë‹¤.' í™•ì‹¤í•œ ê²ƒì´ ì—†ê¸°ì—, ì˜¤íˆë ¤ ììœ ë¡­ë‹¤.",
            principle: "ì°½ì¡°ì  ë‹ˆíë¦¬ì¦˜",
            principleDesc: "ê¸°ì¡´ì˜ ê°€ì¹˜ê°€ ì—†ë‹¤ë©´, ìŠ¤ìŠ¤ë¡œ ê°€ì¹˜ë¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤.",
            evaluation: "í—ˆë¬´ì£¼ì˜ë¥¼ ë„˜ì–´ì„œëŠ” ë‹ˆì²´ì˜ 'ì´ˆì¸' ê°œë…ê³¼ ì—°ê²°ëœë‹¤.",
            nextStage: "stage3_create"
          }
        ]
      },
      
      // Stage 3ë“¤
      {
        id: "stage3_matrix",
        context: "ë‹¹ì‹ ì˜ ì…ì¥ì„ ë” ë°€ì–´ë¶™ì—¬ë³´ì.",
        situation: "ì˜í™” 'ë§¤íŠ¸ë¦­ìŠ¤'ì—ì„œ ì‚¬ì´í¼ëŠ” í˜„ì‹¤ì˜ ê³ í†µë³´ë‹¤ ê°€ì§œ ì„¸ê³„ì˜ í–‰ë³µì„ ì„ íƒí•œë‹¤. 'ë¬´ì§€ê°€ í–‰ë³µì´ë‹¤(Ignorance is bliss).' ì´ ì„ íƒì„ ë¹„ë‚œí•  ìˆ˜ ìˆëŠ”ê°€?",
        choices: [
          {
            text: "ë¹„ë‚œí•  ìˆ˜ ì—†ë‹¤. ê°ìì˜ ì„ íƒì„ ì¡´ì¤‘í•´ì•¼ í•œë‹¤.",
            outcome: "ììœ ì£¼ì˜ì  ì…ì¥ì´ë‹¤. íƒ€ì¸ì—ê²Œ í”¼í•´ë¥¼ ì£¼ì§€ ì•ŠëŠ” í•œ, ê°ìê°€ ìì‹ ì˜ ì‚¶ì„ ê²°ì •í•  ê¶Œë¦¬ê°€ ìˆë‹¤.",
            principle: "ììœ ì˜ì§€ ì¡´ì¤‘",
            principleDesc: "ê° ê°œì¸ì€ ìì‹ ì˜ ì‚¶ì— ëŒ€í•œ ê²°ì •ê¶Œì„ ê°€ì§„ë‹¤.",
            evaluation: "í˜„ëŒ€ ììœ ë¯¼ì£¼ì£¼ì˜ì˜ ê¸°ë°˜ì´ ë˜ëŠ” ì›ì¹™ì´ë‹¤.",
            nextStage: "end"
          },
          {
            text: "ë¹„ë‚œí•  ìˆ˜ ìˆë‹¤. ìê¸°ê¸°ë§Œì€ ìœ¤ë¦¬ì ìœ¼ë¡œ ë¬¸ì œê°€ ìˆë‹¤.",
            outcome: "ì¹¸íŠ¸ì  ì…ì¥ì´ë‹¤. ìê¸° ìì‹ ì—ê²Œì¡°ì°¨ ì •ì§í•´ì•¼ í•  ì˜ë¬´ê°€ ìˆë‹¤. ìŠ¤ìŠ¤ë¡œë¥¼ ì†ì´ëŠ” ê²ƒì€ ì¸ê°„ ì¡´ì—„ì„±ì„ í•´ì¹˜ëŠ” í–‰ìœ„ë‹¤.",
            principle: "ìê¸° ì •ì§ì˜ ì˜ë¬´",
            principleDesc: "ìì‹ ì—ê²Œ ì§„ì‹¤í•´ì•¼ í•œë‹¤. ìê¸°ê¸°ë§Œì€ ìœ¤ë¦¬ì  ë¬¸ì œë‹¤.",
            evaluation: "ì¹¸íŠ¸ì˜ ì •ì–¸ëª…ë ¹ê³¼ ì—°ê²°ë˜ëŠ” ê´€ì ì´ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_meaning",
        context: "ì¾Œë½ê³¼ ì˜ë¯¸ì˜ ì°¨ì´ì— ëŒ€í•´ ë” íƒêµ¬í•´ë³´ì.",
        situation: "ë¹…í„° í”„ë­í´ì€ ì•„ìš°ìŠˆë¹„ì¸ ì—ì„œ ì‚´ì•„ë‚¨ì•˜ë‹¤. ê·¸ëŠ” 'ì‚¶ì˜ ì˜ë¯¸ë¥¼ ì°¾ëŠ” ê²ƒ'ì´ ì¾Œë½ë³´ë‹¤ ì¤‘ìš”í•˜ë‹¤ê³  í–ˆë‹¤. ê³ í†µ ì†ì—ì„œë„ ì˜ë¯¸ë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´, ì˜ë¯¸ ì—†ëŠ” ì¾Œë½ë³´ë‹¤ ì˜ë¯¸ ìˆëŠ” ê³ í†µì´ ë‚˜ì„ ìˆ˜ ìˆëŠ”ê°€?",
        choices: [
          {
            text: "ê·¸ë ‡ë‹¤. ì˜ë¯¸ ìˆëŠ” ê³ í†µì´ ê³µí—ˆí•œ ì¾Œë½ë³´ë‹¤ ë‚«ë‹¤.",
            outcome: "ë¡œê³ í…Œë¼í”¼(ì˜ë¯¸ ì¹˜ë£Œ)ì˜ í•µì‹¬ì´ë‹¤. ì¸ê°„ì€ ì¾Œë½ì´ ì•„ë‹Œ ì˜ë¯¸ë¥¼ ì¶”êµ¬í•˜ëŠ” ì¡´ì¬ë‹¤. ì˜ë¯¸ë¥¼ ì°¾ìœ¼ë©´ ì–´ë–¤ ê³ í†µë„ ê²¬ë”œ ìˆ˜ ìˆë‹¤.",
            principle: "ì˜ë¯¸ ì¶”êµ¬",
            principleDesc: "ì¸ê°„ì˜ ê·¼ë³¸ì  ë™ê¸°ëŠ” ì¾Œë½ì´ ì•„ë‹ˆë¼ ì˜ë¯¸ë‹¤.",
            evaluation: "ë‹ˆì²´ì˜ 'ì™œ ì‚´ì•„ì•¼ í•˜ëŠ”ì§€ ì•„ëŠ” ìëŠ” ì–´ë–¤ ìƒí™©ë„ ê²¬ë”œ ìˆ˜ ìˆë‹¤'ì™€ ë§¥ì„ ê°™ì´ í•œë‹¤.",
            nextStage: "end"
          },
          {
            text: "ê·¸ê±´ ê·¹ë‹¨ì ì´ë‹¤. ì ë‹¹í•œ ê· í˜•ì´ í•„ìš”í•˜ë‹¤.",
            outcome: "ì•„ë¦¬ìŠ¤í† í…”ë ˆìŠ¤ì˜ ì¤‘ìš©(ä¸­åº¸)ê³¼ ë¹„ìŠ·í•˜ë‹¤. ê·¹ë‹¨ì€ í”¼í•˜ê³ , ì¾Œë½ê³¼ ì˜ë¯¸ ì‚¬ì´ì˜ ê· í˜•ì„ ì°¾ëŠ”ë‹¤. ì‹¤ì œ ì‚¶ì—ì„œ ê°€ì¥ í˜„ì‹¤ì ì¸ ì ‘ê·¼ì¼ ìˆ˜ ìˆë‹¤.",
            principle: "ì¤‘ìš©",
            principleDesc: "ê·¹ë‹¨ì„ í”¼í•˜ê³  ê· í˜• ì¡íŒ ì‚¶ì„ ì¶”êµ¬í•œë‹¤.",
            evaluation: "ì•„ë¦¬ìŠ¤í† í…”ë ˆìŠ¤ê°€ ë§í•œ 'ì—ìš°ë‹¤ì´ëª¨ë‹ˆì•„'(ì¢‹ì€ ì‚¶)ì˜ í•µì‹¬ì´ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_real",
        context: "ë‹¹ì‹ ì€ ì™¸ë¶€ ì„¸ê³„ì˜ ì‹¤ì¬ë¥¼ ë¯¿ëŠ”ë‹¤.",
        situation: "ë§ˆì§€ë§‰ ì§ˆë¬¸. ì™¸ë¶€ ì„¸ê³„ê°€ ì‹¤ì¬í•œë‹¤ê³  ì¹˜ì. ê·¸ë ‡ë‹¤ë©´, ê·¸ ì„¸ê³„ì™€ 'ì—°ê²°ë˜ì–´ ìˆë‹¤'ëŠ” ê²ƒì´ ì™œ ì¤‘ìš”í•œê°€? í˜¼ì ê³ ë¦½ë˜ì–´ í–‰ë³µí•œ ê²ƒë³´ë‹¤, íƒ€ì¸ê³¼ ì—°ê²°ëœ ì±„ ê³ í†µë°›ëŠ” ê²ƒì´ ë” ë‚˜ì€ê°€?",
        choices: [
          {
            text: "ì—°ê²°ì´ ì¤‘ìš”í•˜ë‹¤. ì¸ê°„ì€ ì‚¬íšŒì  ì¡´ì¬ë‹¤.",
            outcome: "ì•„ë¦¬ìŠ¤í† í…”ë ˆìŠ¤ëŠ” 'ì¸ê°„ì€ í´ë¦¬ìŠ¤ì  ë™ë¬¼'ì´ë¼ í–ˆë‹¤. ìš°ë¦¬ëŠ” íƒ€ì¸ê³¼ì˜ ê´€ê³„ ì†ì—ì„œ ì •ì²´ì„±ì„ í˜•ì„±í•œë‹¤. ê³ ë¦½ëœ í–‰ë³µì€ ë¶ˆì™„ì „í•˜ë‹¤.",
            principle: "ì‚¬íšŒì  ì¡´ì¬",
            principleDesc: "ì¸ê°„ì˜ ë³¸ì§ˆì€ ê´€ê³„ ì†ì— ìˆë‹¤. ê³ ë¦½ëœ ê°œì¸ì€ ì™„ì „í•˜ì§€ ì•Šë‹¤.",
            evaluation: "ê³µë™ì²´ì£¼ì˜ì™€ ì—°ê²°ë˜ëŠ” ê´€ì ì´ë‹¤.",
            nextStage: "end"
          },
          {
            text: "ê²½ìš°ì— ë”°ë¼ ë‹¤ë¥´ë‹¤. ì—°ê²°ì´ í•­ìƒ ì¢‹ì€ ê±´ ì•„ë‹ˆë‹¤.",
            outcome: "ì‚¬ë¥´íŠ¸ë¥´ëŠ” 'íƒ€ì¸ì€ ì§€ì˜¥ì´ë‹¤'ë¼ê³  í–ˆë‹¤. ê´€ê³„ëŠ” ììœ ë¥¼ ì œí•œí•˜ê¸°ë„ í•œë‹¤. ì—°ê²°ì˜ ê°€ì¹˜ëŠ” ì ˆëŒ€ì ì´ì§€ ì•Šë‹¤.",
            principle: "ê´€ê³„ì˜ ì–‘ë©´ì„±",
            principleDesc: "íƒ€ì¸ê³¼ì˜ ì—°ê²°ì€ ê°€ì¹˜ì´ì ë™ì‹œì— ì œì•½ì´ ë  ìˆ˜ ìˆë‹¤.",
            evaluation: "ì‹¤ì¡´ì£¼ì˜ì  ì‹œê°ì—ì„œ ë³¸ ì¸ê°„ ê´€ê³„ì˜ ë³µì¡ì„±ì´ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_doubt",
        context: "íšŒì˜ì£¼ì˜ë¥¼ ë°›ì•„ë“¤ì˜€ë‹¤.",
        situation: "í™•ì‹¤í•œ ê²ƒì´ ì—†ë‹¤ë©´, ì–´ë–»ê²Œ ì‚´ì•„ì•¼ í•˜ëŠ”ê°€?",
        choices: [
          {
            text: "í™•ì‹¤í•˜ì§€ ì•Šì•„ë„ í–‰ë™í•  ìˆ˜ ìˆë‹¤. ì‚¶ì€ ê³„ì†ëœë‹¤.",
            outcome: "ì¹´ë®ˆì˜ ë¶€ì¡°ë¦¬ ì² í•™ì´ë‹¤. ì„¸ìƒì´ ì˜ë¯¸ ì—†ë‹¤ëŠ” ê²ƒì„ ì•Œë©´ì„œë„, ìš°ë¦¬ëŠ” ê³„ì† ì‚´ì•„ê°„ë‹¤. ì‹œì§€í”„ìŠ¤ì²˜ëŸ¼. ê·¸ë¦¬ê³  ê·¸ ìì²´ê°€ ë°˜í•­ì´ë‹¤.",
            principle: "ë¶€ì¡°ë¦¬ì˜ ìˆ˜ìš©",
            principleDesc: "ì˜ë¯¸ ì—†ìŒì„ ì•Œë©´ì„œë„ ì‚´ì•„ê°€ëŠ” ê²ƒ ìì²´ê°€ ë°˜í•­ì´ë‹¤.",
            evaluation: "'ìš°ë¦¬ëŠ” ì‹œì§€í”„ìŠ¤ê°€ í–‰ë³µí•˜ë‹¤ê³  ìƒìƒí•´ì•¼ í•œë‹¤' - ì¹´ë®ˆ",
            nextStage: "end"
          },
          {
            text: "ìµœì†Œí•œ í™•ì‹¤í•œ ê²ƒë¶€í„° ì‹œì‘í•´ì•¼ í•œë‹¤.",
            outcome: "ë°ì¹´ë¥´íŠ¸ì˜ ë°©ë²•ì  íšŒì˜ë‹¤. ëª¨ë“  ê²ƒì„ ì˜ì‹¬í•˜ë˜, ì˜ì‹¬í•˜ëŠ” ë‚˜ ìì‹ ì˜ ì¡´ì¬ë§Œí¼ì€ í™•ì‹¤í•˜ë‹¤. ê±°ê¸°ì„œë¶€í„° ë‹¤ì‹œ ìŒ“ì•„ì˜¬ë¦°ë‹¤.",
            principle: "ë°©ë²•ì  íšŒì˜",
            principleDesc: "ëª¨ë“  ê²ƒì„ ì˜ì‹¬í•˜ê³ , í™•ì‹¤í•œ ê²ƒ ìœ„ì— ì§€ì‹ì„ ë‹¤ì‹œ ì„¸ìš´ë‹¤.",
            evaluation: "ê·¼ëŒ€ ì² í•™ì˜ ì¶œë°œì ì´ ëœ ë°©ë²•ë¡ ì´ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_pragma",
        context: "ì‹¤ìš©ì£¼ì˜ì  ì ‘ê·¼ì„ ì„ íƒí–ˆë‹¤.",
        situation: "ê·¸ë ‡ë‹¤ë©´ 'ë¯¿ìœ¼ë©´ ì¢‹ì€ ê²ƒ'ì€ ë¬´ì—‡ì¸ê°€? ì§„ì‹¤ë³´ë‹¤ ìœ ìš©í•¨ì´ ë” ì¤‘ìš”í•œê°€?",
        choices: [
          {
            text: "ì¥ê¸°ì ìœ¼ë¡œ ìœ ìš©í•œ ê²ƒì´ ê²°êµ­ ì§„ì‹¤ì— ê°€ê¹ë‹¤.",
            outcome: "ë“€ì´ì˜ ë„êµ¬ì£¼ì˜ë‹¤. ì§„ë¦¬ëŠ” ê³ ì •ëœ ê²ƒì´ ì•„ë‹ˆë¼, ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë„êµ¬ë‹¤. ì„¸ìƒì„ ë” ì˜ ì´í•´í•˜ê³  ëŒ€ì²˜í•˜ê²Œ í•´ì£¼ëŠ” ê²ƒì´ ì§„ë¦¬ë‹¤.",
            principle: "ë„êµ¬ì£¼ì˜",
            principleDesc: "ì§„ë¦¬ëŠ” ë¬¸ì œ í•´ê²°ì˜ ë„êµ¬ë‹¤. ì„¸ìƒì„ ë” ì˜ ë‹¤ë£¨ê²Œ í•´ì£¼ëŠ” ê²ƒì´ ì§„ë¦¬ë‹¤.",
            evaluation: "ê³¼í•™ì˜ ë°œì „ê³¼ë„ ë§¥ì„ ê°™ì´ í•˜ëŠ” ê´€ì ì´ë‹¤.",
            nextStage: "end"
          },
          {
            text: "ì§„ì‹¤ê³¼ ìœ ìš©í•¨ì€ ë‹¤ë¥´ë‹¤. ì“´ ì§„ì‹¤ë„ ìˆë‹¤.",
            outcome: "ì •ì§í•œ ì§€ì ì´ë‹¤. ë¶ˆí¸í•œ ì§„ì‹¤ì´ ìœ ìš©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆê³ , ìœ ìš©í•œ ê±°ì§“ì´ ìˆì„ ìˆ˜ ìˆë‹¤. ì‹¤ìš©ì£¼ì˜ë„ ì™„ë²½í•˜ì§€ ì•Šë‹¤.",
            principle: "ì§„ì‹¤ì˜ ë¬´ì¡°ê±´ì  ê°€ì¹˜",
            principleDesc: "ì§„ì‹¤ì€ ê·¸ ìì²´ë¡œ ê°€ì¹˜ê°€ ìˆë‹¤. ìœ ìš©í•¨ê³¼ ë³„ê°œë‹¤.",
            evaluation: "í”Œë¼í†¤ì˜ ì´ë°ì•„ë¡ ê³¼ ë§¥ì„ ê°™ì´ í•˜ëŠ” ê´€ì ì´ë‹¤.",
            nextStage: "end"
          }
        ]
      },
      
      {
        id: "stage3_create",
        context: "ê°€ì¹˜ë¥¼ ìŠ¤ìŠ¤ë¡œ ì°½ì¡°í•´ì•¼ í•œë‹¤ê³  í–ˆë‹¤.",
        situation: "ê·¸ë ‡ë‹¤ë©´ ë‹¹ì‹ ì€ ì–´ë–¤ ê°€ì¹˜ë¥¼ ì°½ì¡°í•˜ê² ëŠ”ê°€?",
        choices: [
          {
            text: "ë‚˜ ìì‹ ì„ ë„˜ì–´ì„œëŠ” ì„±ì¥. ë‹ˆì²´ì˜ ì´ˆì¸ì²˜ëŸ¼.",
            outcome: "í˜ì—ì˜ ì˜ì§€ë‹¤. ìê¸° ê·¹ë³µ, ëŠì„ì—†ëŠ” ì„±ì¥, ìì‹ ë§Œì˜ ê°€ì¹˜ ì°½ì¡°. ì‰½ì§€ ì•Šì§€ë§Œ, ê°€ì¥ ì¸ê°„ë‹¤ìš´ ê¸¸ì´ë‹¤.",
            principle: "ìê¸° ê·¹ë³µ",
            principleDesc: "ëŠì„ì—†ì´ ìì‹ ì„ ë„˜ì–´ì„œë©° ì„±ì¥í•œë‹¤.",
            evaluation: "ë‹ˆì²´ì˜ 'ì´ˆì¸' ê°œë…ì˜ í•µì‹¬ì´ë‹¤.",
            nextStage: "end"
          },
          {
            text: "íƒ€ì¸ê³¼ í•¨ê»˜í•˜ëŠ” ì˜ë¯¸. ì—°ëŒ€ì™€ ì‚¬ë‘.",
            outcome: "ì—ë¦¬íˆ í”„ë¡¬ì€ 'ì‚¬ë‘ì˜ ê¸°ìˆ 'ì—ì„œ ë§í–ˆë‹¤. ì§„ì •í•œ ì‚¬ë‘ì€ ìì‹ ì˜ ìƒëª…ë ¥ì„ ë‚˜ëˆ„ëŠ” ê²ƒì´ë‹¤. íƒ€ì¸ê³¼ì˜ ì—°ê²°ì—ì„œ ì˜ë¯¸ë¥¼ ì°¾ëŠ”ë‹¤.",
            principle: "ì‚¬ë‘ê³¼ ì—°ëŒ€",
            principleDesc: "íƒ€ì¸ê³¼ì˜ ì—°ê²°ì—ì„œ ì‚¶ì˜ ì˜ë¯¸ë¥¼ ì°¾ëŠ”ë‹¤.",
            evaluation: "ê³µë™ì²´ì  ê°€ì¹˜ë¥¼ ê°•ì¡°í•˜ëŠ” ì…ì¥ì´ë‹¤.",
            nextStage: "end"
          }
        ]
      }
    ];

    let currentStageId = 1;
    let collectedPrinciples = [];
    let stageHistory = [];

    function getStageById(id) {
      return stages.find(s => s.id === id);
    }

    function init() {
      renderProgress();
      renderStage();
      
      document.getElementById('next-btn').addEventListener('click', nextStage);
      document.getElementById('restart-btn').addEventListener('click', restart);
      document.getElementById('native-share-btn').addEventListener('click', nativeShare);
      document.getElementById('copy-btn').addEventListener('click', copyLink);
      document.getElementById('other-toggle').addEventListener('click', toggleOtherChoices);
    }

    function toggleOtherChoices() {
      const content = document.getElementById('other-choices-content');
      const toggle = document.getElementById('other-toggle');
      content.classList.toggle('hidden');
      toggle.classList.toggle('open');
    }

    function renderProgress() {
      const totalStages = 3;
      const currentCount = stageHistory.length;
      
      const progressEl = document.getElementById('progress');
      progressEl.innerHTML = Array(totalStages).fill(0).map((_, idx) => {
        let className = 'progress-bar';
        if (idx < currentCount) className += ' completed';
        else if (idx === currentCount) className += ' current';
        return `<div class="${className}"></div>`;
      }).join('');
    }

    function renderStage() {
      const stage = getStageById(currentStageId);
      if (!stage) return;
      
      document.getElementById('stage-label').textContent = `Stage ${stageHistory.length + 1}`;
      document.getElementById('context').textContent = stage.context;
      document.getElementById('situation').textContent = stage.situation;
      
      const choicesEl = document.getElementById('choices');
      choicesEl.innerHTML = stage.choices.map((choice, idx) => `
        <button class="choice-btn" data-index="${idx}">${choice.text}</button>
      `).join('');
      
      choicesEl.querySelectorAll('.choice-btn').forEach(btn => {
        btn.addEventListener('click', () => handleChoice(parseInt(btn.dataset.index)));
      });
      
      document.getElementById('choices').classList.remove('hidden');
      document.getElementById('result-section').classList.remove('show');
    }

    function handleChoice(index) {
      const stage = getStageById(currentStageId);
      const choice = stage.choices[index];
      
      stageHistory.push({
        stageId: currentStageId,
        choiceIndex: index,
        principle: choice.principle
      });
      
      if (!collectedPrinciples.find(p => p.name === choice.principle)) {
        collectedPrinciples.push({
          name: choice.principle,
          desc: choice.principleDesc
        });
      }
      
      document.getElementById('choices').classList.add('hidden');
      document.getElementById('result-section').classList.add('show');
      
      document.getElementById('selected-text').textContent = choice.text;
      document.getElementById('outcome-text').textContent = choice.outcome;
      document.getElementById('principle-name').textContent = choice.principle;
      document.getElementById('principle-explanation').textContent = choice.principleDesc;
      document.getElementById('evaluation-text').textContent = choice.evaluation;
      
      const otherChoices = stage.choices.filter((_, i) => i !== index);
      const otherContent = document.getElementById('other-choices-content');
      otherContent.innerHTML = otherChoices.map(c => `
        <div class="other-choice-card">
          <div class="other-choice-text">${c.text}</div>
          <div class="other-choice-outcome">${c.outcome}</div>
          <div class="other-choice-principle"><strong>${c.principle}</strong>: ${c.principleDesc}</div>
        </div>
      `).join('');
      
      document.getElementById('other-choices-content').classList.add('hidden');
      document.getElementById('other-toggle').classList.remove('open');
      
      const nextBtn = document.getElementById('next-btn');
      if (choice.nextStage === 'end') {
        nextBtn.textContent = 'ê²°ê³¼ ë³´ê¸°';
      } else {
        nextBtn.textContent = 'ë‹¤ìŒ ì§ˆë¬¸';
      }
      
      currentStageId = choice.nextStage;
      renderProgress();
    }

    function nextStage() {
      if (currentStageId === 'end') {
        showFinalScreen();
      } else {
        renderStage();
      }
    }

    function showFinalScreen() {
      document.getElementById('game-screen').classList.add('hidden');
      document.getElementById('final-screen').classList.add('show');
      
      const principlesList = document.getElementById('principles-list');
      principlesList.innerHTML = collectedPrinciples.map(p => `
        <div class="principle-item">
          <div class="principle-item-icon">ğŸ’­</div>
          <div class="principle-item-content">
            <div class="principle-item-name">${p.name}</div>
            <div class="principle-item-desc">${p.desc}</div>
          </div>
        </div>
      `).join('');
      
      saveProgress();
      showInstallButton();
    }

    function saveProgress() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        const profile = JSON.parse(saved);
        
        if (!profile.completedSims) profile.completedSims = [];
        if (!profile.principles) profile.principles = [];
        
        const isFirstTime = !profile.completedSims.includes(SIM_ID);
        
        if (isFirstTime) {
          profile.completedSims.push(SIM_ID);
          profile.exp = (profile.exp || 0) + 30;
          
          const expNeeded = (profile.level || 1) * 100;
          while (profile.exp >= expNeeded) {
            profile.exp -= expNeeded;
            profile.level = (profile.level || 1) + 1;
          }
        }
        
        collectedPrinciples.forEach(p => {
          if (!profile.principles.find(existing => existing.name === p.name)) {
            profile.principles.push(p);
          }
        });
        
        localStorage.setItem(STORAGE_KEY, JSON.stringify(profile));
      }
    }

    function getShareText() {
      return `ğŸ§  ì´í´ë¦½ìŠ¤ ë§ˆì¸ë“œë©

[ê²½í—˜ ê¸°ê³„] ì‚¬ê³ ì‹¤í—˜ ì™„ë£Œ!

ë°œê²¬í•œ ì² í•™ì  ì›ì¹™ ${collectedPrinciples.length}ê°œ:
${collectedPrinciples.map(p => 'â€¢ ' + p.name).join('\n')}

ë‹¹ì‹ ì€ ê²½í—˜ ê¸°ê³„ì— ë“¤ì–´ê°€ì‹œê² ìŠµë‹ˆê¹Œ?`;
    }

    function nativeShare() {
      if (navigator.share) {
        navigator.share({
          title: 'ê²½í—˜ ê¸°ê³„ - ì´í´ë¦½ìŠ¤ ë§ˆì¸ë“œë©',
          text: getShareText(),
          url: SITE_URL
        }).catch(() => {});
      } else {
        copyLink();
      }
    }

    function copyLink() {
      const text = getShareText() + '\n' + SITE_URL;
      const btn = document.getElementById('copy-btn');
      
      navigator.clipboard.writeText(text).then(() => {
        btn.classList.add('success');
        btn.innerHTML = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> ë³µì‚¬ ì™„ë£Œ!`;
        setTimeout(() => {
          btn.classList.remove('success');
          btn.innerHTML = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> ë§í¬ ë³µì‚¬`;
        }, 2000);
      });
    }

    function restart() {
      currentStageId = 1;
      collectedPrinciples = [];
      stageHistory = [];
      
      document.getElementById('final-screen').classList.remove('show');
      document.getElementById('game-screen').classList.remove('hidden');
      
      renderProgress();
      renderStage();
    }

    // PWA
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
    });

    function showInstallButton() {
      if (deferredPrompt && installBtn) {
        installBtn.classList.remove('hidden');
      }
    }

    installBtn.addEventListener('click', async () => {
      if (!deferredPrompt) return;
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      if (outcome === 'accepted') {
        installBtn.classList.add('hidden');
      }
      deferredPrompt = null;
    });

    window.addEventListener('appinstalled', () => {
      installBtn.classList.add('hidden');
      deferredPrompt = null;
    });

    init();
  </script>
</body>
</html>
