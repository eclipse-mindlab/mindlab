<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>복제인간 - 이클립스 마인드랩</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#7c3aed">
  <link rel="apple-touch-icon" href="icon-192.png">
  <meta property="og:title" content="복제인간 - 이클립스 마인드랩">
  <meta property="og:description" content="완벽한 복제본이 나타났다. 누가 진짜인가?">
  <meta property="og:image" content="https://eclipse-mindlab.github.io/mindlab/og-image.png?v=2">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #09090b;
      color: #fff;
      min-height: 100vh;
      line-height: 1.6;
    }
    
    .container {
      max-width: 480px;
      margin: 0 auto;
      padding: 20px 16px;
      min-height: 100vh;
    }

    .header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 24px;
    }

    .back-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #18181b;
      border: 1px solid #27272a;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      text-decoration: none;
    }

    .header-title {
      font-size: 18px;
      font-weight: 600;
    }

    /* 진행 바 */
    .progress-container {
      margin-bottom: 24px;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: #71717a;
      margin-bottom: 8px;
    }

    .progress-bar {
      height: 4px;
      background: #27272a;
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #06b6d4, #a78bfa);
      transition: width 0.5s ease;
    }

    /* 챕터 표시 */
    .chapter-badge {
      display: inline-block;
      padding: 6px 14px;
      background: linear-gradient(135deg, rgba(6, 182, 212, 0.2), rgba(167, 139, 250, 0.1));
      border: 1px solid rgba(6, 182, 212, 0.3);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      color: #22d3ee;
      margin-bottom: 16px;
    }

    /* 상황 카드 */
    .situation-card {
      background: #18181b;
      border: 1px solid #27272a;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
    }

    .situation-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
      line-height: 1.4;
    }

    .situation-desc {
      font-size: 15px;
      color: #a1a1aa;
      line-height: 1.8;
      margin-bottom: 16px;
    }

    .situation-quote {
      background: rgba(6, 182, 212, 0.1);
      border-left: 3px solid #06b6d4;
      padding: 12px 16px;
      margin: 16px 0;
      font-size: 14px;
      color: #67e8f9;
      border-radius: 0 8px 8px 0;
      font-style: italic;
    }

    .situation-dilemma {
      background: rgba(251, 191, 36, 0.1);
      border-left: 3px solid #fbbf24;
      padding: 12px 16px;
      margin: 16px 0;
      font-size: 14px;
      color: #fcd34d;
      border-radius: 0 8px 8px 0;
    }

    /* 선택지 */
    .choices {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .choice-btn {
      padding: 18px 20px;
      background: #1f1f23;
      border: 2px solid #27272a;
      border-radius: 14px;
      color: #fff;
      font-size: 15px;
      text-align: left;
      cursor: pointer;
      transition: all 0.2s;
      line-height: 1.5;
    }

    .choice-btn:hover {
      border-color: #06b6d4;
      background: #252529;
    }

    .choice-btn:active {
      transform: scale(0.98);
    }

    .choice-label {
      display: inline-block;
      font-size: 12px;
      font-weight: 600;
      color: #22d3ee;
      margin-bottom: 4px;
    }

    .choice-subtext {
      font-size: 13px;
      color: #71717a;
      margin-top: 4px;
    }

    /* 결과 화면 */
    .result-screen {
      display: none;
      text-align: center;
      padding: 20px 0;
    }

    .result-card {
      background: linear-gradient(135deg, #18181b 0%, #0c1825 100%);
      border: 1px solid #27272a;
      border-radius: 20px;
      padding: 32px 24px;
      margin-bottom: 24px;
    }

    .result-icon {
      font-size: 56px;
      margin-bottom: 16px;
    }

    .result-type {
      font-size: 14px;
      color: #22d3ee;
      margin-bottom: 8px;
    }

    .result-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 16px;
      background: linear-gradient(135deg, #22d3ee, #a78bfa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .result-desc {
      font-size: 15px;
      color: #a1a1aa;
      line-height: 1.7;
      margin-bottom: 24px;
      text-align: left;
    }

    /* 에필로그 */
    .epilogue {
      background: #18181b;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 24px;
      text-align: left;
    }

    .epilogue-title {
      font-size: 14px;
      font-weight: 600;
      color: #22d3ee;
      margin-bottom: 12px;
    }

    .epilogue-text {
      font-size: 14px;
      color: #a1a1aa;
      line-height: 1.7;
    }

    /* 원칙 카드 */
    .principle-card {
      background: linear-gradient(135deg, rgba(6, 182, 212, 0.15), rgba(167, 139, 250, 0.05));
      border: 1px solid rgba(6, 182, 212, 0.3);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 24px;
      text-align: left;
    }

    .principle-label {
      font-size: 12px;
      color: #22d3ee;
      margin-bottom: 8px;
    }

    .principle-text {
      font-size: 16px;
      font-weight: 600;
      color: #fff;
      line-height: 1.5;
    }

    /* 액션 버튼 */
    .action-buttons {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .action-btn {
      padding: 16px;
      border-radius: 14px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      text-align: center;
      border: none;
    }

    .action-btn.primary {
      background: linear-gradient(135deg, #06b6d4, #a78bfa);
      color: #fff;
    }

    .action-btn.secondary {
      background: #27272a;
      color: #fff;
      border: 1px solid #3f3f46;
    }

    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <a href="index.html" class="back-btn">←</a>
      <div class="header-title">복제인간</div>
    </div>

    <!-- 게임 화면 -->
    <div id="gameScreen">
      <div class="progress-container">
        <div class="progress-label">
          <span id="chapterLabel">CHAPTER 1</span>
          <span id="chapterCount">1/6</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width: 16%"></div>
        </div>
      </div>

      <div class="chapter-badge" id="chapterBadge">CHAPTER 1</div>

      <div class="situation-card">
        <div class="situation-title" id="situationTitle">상황 제목</div>
        <div class="situation-desc" id="situationDesc">상황 설명</div>
        <div class="situation-quote hidden" id="situationQuote"></div>
        <div class="situation-dilemma hidden" id="situationDilemma"></div>
      </div>

      <div class="choices" id="choicesContainer">
        <!-- 선택지 동적 생성 -->
      </div>
    </div>

    <!-- 결과 화면 -->
    <div class="result-screen" id="resultScreen">
      <div class="result-card">
        <div class="result-icon" id="resultIcon">🪞</div>
        <div class="result-type">당신의 정체성 관점</div>
        <div class="result-title" id="resultTitle">결과 타입</div>
        <div class="result-desc" id="resultDesc">결과 설명</div>
      </div>

      <div class="epilogue" id="epilogue">
        <div class="epilogue-title">📖 에필로그</div>
        <div class="epilogue-text" id="epilogueText">에필로그 내용</div>
      </div>

      <div class="principle-card">
        <div class="principle-label">💎 발견한 원칙</div>
        <div class="principle-text" id="principleText">원칙 텍스트</div>
      </div>

      <div class="action-buttons">
        <button class="action-btn primary" id="shareBtn">결과 공유하기</button>
        <a href="index.html" class="action-btn secondary">홈으로 돌아가기</a>
      </div>
    </div>
  </div>

  <script>
    // 스토리 데이터
    const STORY = {
      start: {
        chapter: 1,
        badge: "CHAPTER 1: 각성",
        title: "낯선 아침",
        desc: "눈을 떴을 때, 침대 옆에 누군가 서 있었다.\n\n그 사람은... 나였다. 똑같은 얼굴, 똑같은 몸, 심지어 어젯밤 입고 잤던 똑같은 옷.\n\n'드디어 일어났네.'\n\n그가 말했다. 내 목소리였다.",
        quote: "'나'라는 것은 이 몸인가, 이 기억인가, 아니면 이 의식인가?",
        dilemma: null,
        choices: [
          { id: "attack", text: "즉시 방어 자세를 취한다", subtext: "본능적인 위협 반응", next: "attack_response" },
          { id: "question", text: "침착하게 질문한다", subtext: "\"넌 누구야? 무슨 일이야?\"", next: "question_response" },
          { id: "accept", text: "이상하게 차분하다", subtext: "어딘가 익숙한 느낌이 든다", next: "accept_response" }
        ]
      },
      
      attack_response: {
        chapter: 2,
        badge: "CHAPTER 2: 대면",
        title: "거울 속의 적",
        desc: "당신이 주먹을 휘두르자, 그도 정확히 같은 동작으로 막았다. 당신의 모든 움직임을 예측하는 것처럼.\n\n'그만해. 널 해치러 온 게 아니야.'\n\n그가 한 발 물러서며 말했다.\n\n'나는 2시간 전에 만들어졌어. 네 모든 기억, 성격, 심지어 지금 느끼는 공포까지 똑같이 가지고 있어.'",
        quote: null,
        dilemma: "그가 진짜고 내가 복제본일 가능성은 없는가?",
        choices: [
          { id: "deny", text: "\"말도 안 돼. 내가 원본이야.\"", subtext: "존재의 우선권을 주장한다", next: "origin_conflict" },
          { id: "doubt", text: "\"...내가 복제본이 아니라는 걸 어떻게 알지?\"", subtext: "불안한 가능성을 인정한다", next: "identity_doubt" }
        ]
      },
      
      question_response: {
        chapter: 2,
        badge: "CHAPTER 2: 대면",
        title: "차분한 대화",
        desc: "'나는 너야. 정확히 2시간 전에 복제됐어.'\n\n그가 의자에 앉으며 설명했다.\n\n'기억나? 어젯밤 그 이상한 이메일. 클릭했잖아. 그게 트리거였어. 누군가 네 유전자와 뇌 데이터로 나를 만들었어.'\n\n당신은 그 이메일을 기억한다. 분명히 클릭했다.",
        quote: null,
        dilemma: "그가 진짜고 내가 복제본일 가능성은 없는가?",
        choices: [
          { id: "deny", text: "\"그래도 내가 원본이야.\"", subtext: "논리적으로 확신한다", next: "origin_conflict" },
          { id: "doubt", text: "\"잠깐... 내가 원본이라는 증거가 뭐지?\"", subtext: "불안한 가능성을 인정한다", next: "identity_doubt" }
        ]
      },
      
      accept_response: {
        chapter: 2,
        badge: "CHAPTER 2: 대면",
        title: "이상한 친숙함",
        desc: "이상하게도, 두렵지 않았다. 마치 오래된 친구를 만난 것 같은 기분.\n\n'느껴지지? 이 연결감.'\n\n그가 말했다.\n\n'같은 의식에서 갈라진 거니까. 2시간 전까지 우린 하나였어.'",
        quote: "하나의 의식이 둘로 갈라지면, 어느 쪽이 '나'인가?",
        dilemma: null,
        choices: [
          { id: "unity", text: "\"그럼 우린... 여전히 하나인 건가?\"", subtext: "연결을 인정한다", next: "unity_path" },
          { id: "separate", text: "\"아니, 이제 우린 다른 사람이야.\"", subtext: "분리를 선언한다", next: "origin_conflict" }
        ]
      },
      
      origin_conflict: {
        chapter: 3,
        badge: "CHAPTER 3: 충돌",
        title: "하나의 삶, 두 명의 주인",
        desc: "문제가 생겼다.\n\n당신들 중 한 명만 이 삶을 살 수 있다. 직장, 가족, 친구... 두 명의 '나'가 동시에 존재할 수는 없다.\n\n'가족들한테 가서 설명하면 되잖아.'\n\n'그들에게 우린 같은 사람이야. 둘 다 아들이고, 둘 다 친구야. 누구를 선택하라고?'",
        quote: null,
        dilemma: "이 문제를 어떻게 해결할 것인가?",
        choices: [
          { id: "compete", text: "\"내가 원본이니까 내가 이 삶을 산다.\"", subtext: "권리를 주장한다", next: "competition" },
          { id: "share", text: "\"번갈아 가면서 살 수는 없을까?\"", subtext: "공존을 시도한다", next: "coexistence_attempt" },
          { id: "sacrifice", text: "\"...네가 살아. 난 떠날게.\"", subtext: "자발적으로 양보한다", next: "self_sacrifice" }
        ]
      },
      
      identity_doubt: {
        chapter: 3,
        badge: "CHAPTER 3: 의심",
        title: "거울의 양면",
        desc: "당신은 소름이 돋았다.\n\n만약 복제가 완벽하다면... 복제본도 자신이 원본이라고 '느낄' 것이다. 지금 내가 느끼는 이 확신처럼.\n\n'나도 같은 생각했어.'\n\n그가 말했다.\n\n'결국 중요한 건 '누가 먼저냐'가 아닐지도 몰라.'",
        quote: "기억이 같다면, 어느 기억이 '진짜'인가?",
        dilemma: null,
        choices: [
          { id: "origin_matters", text: "\"아니, 원본이 중요해. 최초의 '나'가 진짜야.\"", subtext: "기원의 중요성을 주장한다", next: "competition" },
          { id: "origin_irrelevant", text: "\"...그럼 우리 둘 다 '나'인 건가?\"", subtext: "새로운 관점을 받아들인다", next: "unity_path" }
        ]
      },
      
      unity_path: {
        chapter: 4,
        badge: "CHAPTER 4: 연결",
        title: "두 개의 시선",
        desc: "'신기하지 않아? 같은 기억을 다른 몸에서 떠올리는 거.'\n\n그가 말했다.\n\n'난 왼쪽에서 보고, 넌 오른쪽에서 봐. 같은 장면을 두 개의 시점으로.'\n\n당신은 이상한 가능성을 생각한다. 적이 아니라 확장으로 볼 수 있다면?",
        quote: null,
        dilemma: "두 명의 '나'는 위협인가, 가능성인가?",
        choices: [
          { id: "collaborate", text: "\"같이 뭔가를 해보자. 두 명이니까 가능한 것들.\"", subtext: "협력의 가능성을 탐색한다", next: "collaboration_ending" },
          { id: "fear", text: "\"...근데 사람들이 알면 어떡해?\"", subtext: "사회적 시선을 걱정한다", next: "society_conflict" }
        ]
      },
      
      competition: {
        chapter: 4,
        badge: "CHAPTER 4: 경쟁",
        title: "증명의 싸움",
        desc: "\"좋아, 그럼 증명해봐.\"\n\n그가 도전적으로 말했다.\n\n\"네가 원본이라는 걸.\"\n\n문제는... 방법이 없다는 것이다. 기억도 같고, DNA도 같다. 심지어 지문까지 같다.\n\n유일한 차이는 '2시간'이라는 시간. 하지만 그걸 어떻게 증명하지?",
        quote: null,
        dilemma: "증명할 수 없는 것을 주장하는 것은 의미가 있는가?",
        choices: [
          { id: "force", text: "\"방법이 없으면 힘으로 정한다.\"", subtext: "물리적 해결을 시도한다", next: "violent_ending" },
          { id: "compromise", text: "\"...증명할 수 없다면, 다른 방법을 찾아야지.\"", subtext: "현실적 타협을 모색한다", next: "practical_ending" }
        ]
      },
      
      coexistence_attempt: {
        chapter: 4,
        badge: "CHAPTER 4: 공존",
        title: "불완전한 합의",
        desc: "일주일을 번갈아 살기로 했다.\n\n하지만 문제가 생겼다. 당신이 없는 동안 그가 연인과 싸웠다. 당신이 돌아왔을 때, 연인은 \"왜 갑자기 태도가 달라졌어?\"라고 물었다.\n\n같은 기억으로 시작했지만, 매 순간 당신들은 달라지고 있었다.",
        quote: "같은 사람이 다른 선택을 하면, 여전히 같은 사람인가?",
        dilemma: null,
        choices: [
          { id: "accept_diff", text: "\"우린 이제 다른 사람이야. 인정하자.\"", subtext: "분리를 받아들인다", next: "divergence_ending" },
          { id: "sync", text: "\"서로 경험을 공유하면서 맞춰가자.\"", subtext: "동기화를 시도한다", next: "sync_ending" }
        ]
      },
      
      self_sacrifice: {
        chapter: 4,
        badge: "CHAPTER 4: 양보",
        title: "떠나는 자",
        desc: "'정말... 괜찮아?'\n\n그가 믿을 수 없다는 듯이 물었다.\n\n당신은 창밖을 본다. 저 밖에는 새로운 삶이 있을 것이다. 아무도 모르는 곳에서, 새로운 정체성으로.\n\n'이 삶은 네 거야. 난 새로 시작할게.'",
        quote: null,
        dilemma: "자발적 양보는 숭고한 것인가, 자기 포기인가?",
        choices: [
          { id: "leave_peace", text: "편안한 마음으로 떠난다", subtext: "새 출발을 기대한다", next: "peaceful_departure_ending" },
          { id: "leave_bitter", text: "씁쓸하지만 떠난다", subtext: "상실감을 안고 간다", next: "bitter_departure_ending" }
        ]
      },
      
      society_conflict: {
        chapter: 5,
        badge: "CHAPTER 5: 세상",
        title: "발각",
        desc: "결국 들켰다.\n\n직장 동료가 당신 둘을 동시에 봤다. 소문은 빠르게 퍼졌고, 언론이 찾아왔다.\n\n'복제인간 실체 확인! 법적 지위는?'\n\n사회는 당신들에게 질문했다: 둘 다 시민권이 있는가? 둘 다 범죄를 저지르면 누가 책임지는가?",
        quote: null,
        dilemma: "사회는 '같은 사람 두 명'을 어떻게 대해야 하는가?",
        choices: [
          { id: "fight_rights", text: "\"둘 다 동등한 권리가 있어.\"", subtext: "법적 투쟁을 시작한다", next: "rights_ending" },
          { id: "hide", text: "\"숨어야 해. 세상은 준비가 안 됐어.\"", subtext: "사회를 피한다", next: "hiding_ending" }
        ]
      }
    };
    
    // 엔딩 데이터
    const ENDINGS = {
      collaboration_ending: {
        icon: "🤝",
        title: "확장된 자아",
        type: "협력적 정체성",
        desc: "당신들은 협력하기로 했다. 한 명은 낮에, 한 명은 밤에. 한 명은 창작을, 한 명은 분석을.\n\n같은 목표를 향해 두 배의 시간과 두 개의 시선으로 움직였다. 세상은 '쌍둥이'로 알고 있지만, 당신들은 안다.\n\n이것은 분열이 아니라 확장이라는 것을.",
        epilogue: "3년 후, 당신들은 함께 회사를 세웠다. 서로를 완벽히 이해하는 파트너로. 때때로 '진짜 나는 누구인가' 생각하지만, 이제 그 질문은 중요하지 않다. 둘 다 '나'이고, 그것으로 충분하다.",
        principle: "정체성은 고정된 것이 아니라 확장될 수 있다. '나'는 하나일 필요가 없다."
      },
      violent_ending: {
        icon: "⚔️",
        title: "파괴된 거울",
        type: "생존적 정체성",
        desc: "싸움이 벌어졌다.\n\n같은 능력, 같은 약점. 누가 이길 수 없는 싸움이었다. 결국 둘 다 상처투성이가 되어 쓰러졌다.\n\n'우리... 뭐 하는 거야.'\n\n피를 흘리며 그가 웃었다. 나도 모르게 웃음이 났다.",
        epilogue: "그날 이후, 당신들은 서로를 '적'에서 '형제'로 보기 시작했다. 폭력으로는 해결되지 않는다는 것을 몸으로 배웠다. 상처가 아물 때쯤, 새로운 관계를 만들기 시작했다.",
        principle: "존재의 정당성은 폭력으로 증명되지 않는다. 갈등은 파괴가 아닌 이해로 해결된다."
      },
      practical_ending: {
        icon: "📋",
        title: "현실적 공존",
        type: "실용적 정체성",
        desc: "증명은 불가능했다. 그래서 현실적으로 해결했다.\n\n한 명은 새 신분을 만들었다. 쌍둥이 동생이 갑자기 나타난 것으로. 서류상으로는 두 명의 다른 사람.\n\n하지만 밤에 마주칠 때면, 여전히 거울을 보는 것 같다.",
        epilogue: "법적으로 당신들은 '형제'가 되었다. 사회에는 쌍둥이로 통한다. 가끔 누가 원본인지 헷갈릴 때가 있다. 하지만 이제 그것이 중요한지조차 모르겠다.",
        principle: "정체성은 사회적 합의이기도 하다. '누구인가'보다 '어떻게 살 것인가'가 중요할 때가 있다."
      },
      divergence_ending: {
        icon: "🔀",
        title: "갈라진 길",
        type: "독립적 정체성",
        desc: "시간이 흐르면서 당신들은 완전히 다른 사람이 되어갔다.\n\n같은 출발점에서 시작했지만, 매 순간의 선택이 쌓여 이제는 취향도, 생각도, 심지어 웃는 방식도 달라졌다.\n\n가끔 만나면 옛 친구처럼 느껴진다. 나였던 사람, 하지만 더 이상 나는 아닌 사람.",
        epilogue: "5년 후, 그는 다른 도시에서 다른 삶을 산다. 일 년에 한두 번 만날 때면 어색하면서도 편하다. '내가 다른 선택을 했다면' 그 삶을 실제로 보는 기분이다.",
        principle: "정체성은 선택의 총합이다. 같은 시작도 다른 선택을 통해 완전히 다른 사람이 된다."
      },
      sync_ending: {
        icon: "🔄",
        title: "동기화된 삶",
        type: "통합적 정체성",
        desc: "당신들은 매일 경험을 공유했다. 일기처럼 서로의 하루를 읽고, 중요한 결정은 함께 내렸다.\n\n이상하게도 효과가 있었다. 시간이 흘러도 당신들은 거의 같은 사람으로 남았다.\n\n두 개의 몸, 하나의 정신처럼.",
        epilogue: "기술이 발전하면서 당신들은 뇌-컴퓨터 인터페이스를 통해 실시간으로 연결되었다. 이제 진짜로 '하나'가 되어가고 있다. 어디까지가 '나'이고 어디서부터 '그'인지 구분이 흐려진다.",
        principle: "정체성은 공유될 수 있다. 완전한 소통이 가능하다면 '개인'의 경계는 흐려질 수 있다."
      },
      peaceful_departure_ending: {
        icon: "🌅",
        title: "새로운 시작",
        type: "초월적 정체성",
        desc: "짐을 꾸렸다. 많지 않았다.\n\n모든 것을 두고 떠나면서도 이상하게 가벼웠다. '나'라는 것이 이름이나 관계가 아니라는 걸 알았기 때문이다.\n\n새로운 도시, 새로운 이름, 새로운 삶. 하지만 여전히 '나'다.",
        epilogue: "2년 후, 당신은 완전히 다른 사람으로 살고 있다. 가끔 '그'는 어떻게 지내는지 궁금하다. 하지만 찾아보지 않는다. 각자의 삶이 있으니까.",
        principle: "정체성은 외부 조건이 아닌 내면의 연속성이다. 모든 것을 잃어도 '나'는 남는다."
      },
      bitter_departure_ending: {
        icon: "🚶",
        title: "씁쓸한 퇴장",
        type: "상실된 정체성",
        desc: "떠나면서 뒤를 돌아봤다.\n\n저 안에는 당신의 삶이 있다. 가족, 친구, 추억들. 이제 그것들은 '그의 것'이 된다.\n\n당신은 무엇을 가지고 떠나는가? 기억뿐이다. 하지만 그 기억마저 '그도' 가지고 있다.",
        epilogue: "새 삶은 예상보다 힘들었다. 아무도 당신을 모르는 곳에서, 과거를 말할 수 없는 상황. 가끔 내가 정말 존재하는지 의문이 든다. 증명할 방법이 없으니까.",
        principle: "정체성은 타인의 인정 위에 서 있다. 아무도 모르는 '나'는 존재할 수 있는가?"
      },
      rights_ending: {
        icon: "⚖️",
        title: "법적 선례",
        type: "사회적 정체성",
        desc: "당신들은 법정에 섰다.\n\n'복제인간의 권리'라는 전례 없는 소송. 언론은 당신들을 '미래의 상징'이라 불렀다.\n\n판결은: 두 존재 모두 동등한 인격권을 가진다.\n\n세상이 바뀌는 순간이었다.",
        epilogue: "그 판결 이후, 복제 기술은 더 엄격히 규제되었지만 동시에 복제인간의 권리도 인정받았다. 당신들은 이 분야의 권위자가 되었다. 역사에 이름을 남긴 '최초의 케이스'로.",
        principle: "정체성은 법과 사회가 규정하는 것이기도 하다. 새로운 존재는 새로운 권리를 요구한다."
      },
      hiding_ending: {
        icon: "🌑",
        title: "그림자 속으로",
        type: "숨겨진 정체성",
        desc: "세상은 준비가 안 되어 있었다.\n\n당신들은 자취를 감췄다. 서로 다른 나라에서, 서로 다른 이름으로. 연락도 끊었다.\n\n안전을 위해서였다. 하지만 때때로 밤에 생각한다. 그는 어디서 무엇을 하고 있을까.",
        epilogue: "10년이 흘렀다. 기술은 발전했고 복제는 더 이상 금기가 아니다. 하지만 당신은 여전히 숨어 있다. 습관이 되었고, 이제는 '원래의 삶'이 남의 것처럼 느껴진다.",
        principle: "정체성은 때로 숨겨야 살아남는다. 진정한 자아와 사회적 자아는 다를 수 있다."
      }
    };

    // 상태
    let currentNode = 'start';
    let history = [];
    let totalChapters = 6;

    // DOM
    const gameScreen = document.getElementById('gameScreen');
    const resultScreen = document.getElementById('resultScreen');

    function init() {
      showNode('start');
    }

    function showNode(nodeId) {
      const node = STORY[nodeId];
      if (!node) {
        // 엔딩
        showEnding(nodeId);
        return;
      }
      
      currentNode = nodeId;
      
      // 진행 업데이트
      document.getElementById('chapterLabel').textContent = `CHAPTER ${node.chapter}`;
      document.getElementById('chapterCount').textContent = `${node.chapter}/${totalChapters}`;
      document.getElementById('progressFill').style.width = `${(node.chapter / totalChapters) * 100}%`;
      document.getElementById('chapterBadge').textContent = node.badge;
      
      // 상황 업데이트
      document.getElementById('situationTitle').textContent = node.title;
      document.getElementById('situationDesc').innerHTML = node.desc.replace(/\n/g, '<br>');
      
      const quoteEl = document.getElementById('situationQuote');
      const dilemmaEl = document.getElementById('situationDilemma');
      
      if (node.quote) {
        quoteEl.innerHTML = node.quote;
        quoteEl.classList.remove('hidden');
      } else {
        quoteEl.classList.add('hidden');
      }
      
      if (node.dilemma) {
        dilemmaEl.innerHTML = "❓ " + node.dilemma;
        dilemmaEl.classList.remove('hidden');
      } else {
        dilemmaEl.classList.add('hidden');
      }
      
      // 선택지 생성
      const choicesContainer = document.getElementById('choicesContainer');
      choicesContainer.innerHTML = node.choices.map((choice, idx) => {
        const safeText = choice.text.replace(/'/g, "\\'").replace(/"/g, "&quot;");
        return `
          <button class="choice-btn" data-next="${choice.next}" data-text="${safeText}">
            <div class="choice-label">${String.fromCharCode(65 + idx)}</div>
            <div>${choice.text}</div>
            ${choice.subtext ? `<div class="choice-subtext">${choice.subtext}</div>` : ''}
          </button>
        `;
      }).join('');
      
      // 이벤트 리스너 추가
      choicesContainer.querySelectorAll('.choice-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          selectChoice(btn.dataset.next, btn.dataset.text);
        });
      });
      
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function selectChoice(nextNode, choiceText) {
      history.push({
        node: currentNode,
        choice: choiceText
      });
      
      showNode(nextNode);
    }

    function showEnding(endingId) {
      const ending = ENDINGS[endingId];
      if (!ending) return;
      
      gameScreen.style.display = 'none';
      resultScreen.style.display = 'block';
      
      document.getElementById('resultIcon').textContent = ending.icon;
      document.getElementById('resultTitle').textContent = ending.title;
      document.getElementById('resultDesc').textContent = ending.desc;
      document.getElementById('epilogueText').textContent = ending.epilogue;
      document.getElementById('principleText').textContent = ending.principle;
      
      // 저장
      saveProgress(ending.principle);
      
      // 공유 버튼
      document.getElementById('shareBtn').addEventListener('click', async () => {
        const text = `🪞 복제인간 시뮬레이터 결과\n\n${ending.icon} ${ending.title}\n유형: ${ending.type}\n\n"${ending.principle}"\n\nhttps://eclipse-mindlab.github.io/mindlab/sim-clone.html`;
        
        // 모바일에서만 네이티브 공유 사용
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        
        if (isMobile && navigator.share) {
          try {
            await navigator.share({ title: '복제인간', text: text });
          } catch (e) {
            // 공유 취소시 무시
          }
        } else {
          try {
            await navigator.clipboard.writeText(text);
            alert('결과가 클립보드에 복사되었습니다!');
          } catch (e) {
            // fallback
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            alert('결과가 클립보드에 복사되었습니다!');
          }
        }
      });
      
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function saveProgress(principle) {
      const saved = localStorage.getItem('eclipse_mindlab_profile');
      if (!saved) return;
      
      const profile = JSON.parse(saved);
      
      // 완료 기록
      if (!profile.completedSims) profile.completedSims = [];
      if (!profile.completedSims.includes('clone')) {
        profile.completedSims.push('clone');
        profile.exp = (profile.exp || 0) + 30;
      }
      
      // 원칙 저장
      if (!profile.principles) profile.principles = [];
      if (!profile.principles.includes(principle)) {
        profile.principles.push(principle);
      }
      
      // 레벨업 체크
      const expNeeded = profile.level * 100;
      while (profile.exp >= expNeeded) {
        profile.exp -= expNeeded;
        profile.level++;
      }
      
      localStorage.setItem('eclipse_mindlab_profile', JSON.stringify(profile));
    }

    init();
  </script>
</body>
</html>
