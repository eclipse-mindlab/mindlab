<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>트롤리 딜레마 - 이클립스의 딜렘</title>
  <link rel="stylesheet" href="sim-template.css">
  <meta property="og:title" content="트롤리 딜레마 - 이클립스의 딜렘">
  <meta property="og:description" content="당신의 도덕적 기준은 어디까지 흔들릴까?">
  <meta property="og:image" content="https://eclipse-mindlab.github.io/mindlab/og-image.png?v=2">
  <style>
    :root {
      --sim-primary: #a855f7;
      --sim-primary-light: #c084fc;
      --sim-primary-bg: rgba(168, 85, 247, 0.1);
      --sim-primary-border: rgba(168, 85, 247, 0.3);
    }
  </style>
</head>
<body>
  <div class="sim-container">
    <!-- 헤더 -->
    <div class="sim-header">
      <a href="index.html" class="sim-back-btn">←</a>
      <div class="sim-header-title">트롤리 딜레마</div>
    </div>

    <!-- 게임 화면 -->
    <div id="gameScreen">
      <div class="sim-progress">
        <div class="sim-progress-label">
          <span id="stageLabel">STAGE 1</span>
          <span id="stageCount">1/5</span>
        </div>
        <div class="sim-progress-bar">
          <div class="sim-progress-fill" id="progressFill" style="width: 20%"></div>
        </div>
      </div>

      <div class="sim-stage-badge" id="stageBadge">STAGE 1: 클래식</div>

      <div class="sim-situation">
        <div class="sim-situation-title" id="situationTitle">상황 제목</div>
        <div class="sim-situation-desc" id="situationDesc">상황 설명</div>
        <div class="sim-situation-highlight hidden" id="situationHighlight"></div>
        <div class="sim-situation-quote hidden" id="situationQuote"></div>
      </div>

      <div class="sim-choices" id="choices"></div>
    </div>

    <!-- 해설 화면 -->
    <div id="explanationScreen" class="hidden">
      <div class="sim-explanation-card">
        <div class="sim-explanation-label">당신의 선택</div>
        <div class="sim-explanation-title" id="yourChoice">선택 내용</div>
      </div>

      <div class="sim-explanation-card hidden" id="meaningCard">
        <div class="sim-explanation-label">이 선택이 의미하는 것</div>
        <div class="sim-explanation-desc" id="choiceMeaning">해설 내용</div>
      </div>

      <div class="sim-principle-card hidden" id="principleCard">
        <div class="sim-principle-header">
          <span class="sim-principle-icon">💡</span>
          <span>발견한 철학적 원칙</span>
        </div>
        <div class="sim-principle-name" id="principleName">원칙 이름</div>
        <div class="sim-principle-desc" id="principleDesc">원칙 설명</div>
      </div>

      <div class="sim-quote-card hidden" id="quoteCard">
        <span class="sim-quote-icon">💬</span>
        <span class="sim-quote-text" id="quoteText">인용구</span>
      </div>

      <button class="sim-next-btn" id="nextBtn">다음으로</button>
    </div>

    <!-- 결과 화면 -->
    <div id="resultScreen" class="hidden">
      <div class="sim-result-card">
        <div class="sim-result-icon" id="resultIcon">🚃</div>
        <div class="sim-result-label" id="resultLabel">당신의 도덕 유형</div>
        <div class="sim-result-title" id="resultTitle">결과 타입</div>
        <div class="sim-result-stats hidden" id="resultStats"></div>
        <div class="sim-result-desc" id="resultDesc">결과 설명</div>
      </div>

      <div class="sim-principles-list hidden" id="principlesList"></div>

      <div class="sim-actions">
        <button class="sim-action-btn primary" id="shareBtn">결과 공유하기</button>
        <a href="index.html" class="sim-action-btn secondary">홈으로 돌아가기</a>
      </div>

      <!-- 프로모션 섹션 -->
      <div class="sim-promo">
        <div class="sim-promo-title">이클립스 더 알아보기</div>
        <a href="https://www.youtube.com/@Eclipse-g4e" target="_blank" class="sim-youtube-btn">
          <span class="sim-youtube-icon">▶</span>
          <span>유튜브 채널</span>
        </a>
        
        <div class="sim-books">
          <div class="sim-books-title">이클립스의 책</div>
          <div class="sim-books-grid">
            <a href="https://litt.ly/eclipse.thinker" target="_blank" class="sim-book-item">
              <img src="book-philosophy.png" alt="훔친 철학 편" class="sim-book-cover">
              <div class="sim-book-title">훔친 철학 편</div>
            </a>
            <a href="https://litt.ly/eclipse.thinker" target="_blank" class="sim-book-item">
              <img src="book-psychology.png" alt="훔친 심리학 편" class="sim-book-cover">
              <div class="sim-book-title">훔친 심리학 편</div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="sim-template.js"></script>
  <script>
    const CONFIG = {
      id: 'trolley',
      title: '트롤리 딜레마',
      shareIcon: '🚃',
      shareUrl: 'https://eclipse-mindlab.github.io/mindlab/sim-trolley.html',
      
      stages: [
        {
          badge: 'STAGE 1: 클래식',
          title: '폭주하는 트롤리',
          desc: '당신은 선로 옆에 서 있다. 브레이크가 고장난 트롤리가 달려오고 있고, 선로 위에는 5명의 인부가 일하고 있다.\n\n당신 옆에는 레버가 있다. 레버를 당기면 트롤리가 다른 선로로 바뀌지만, 그 선로에는 1명의 인부가 있다.',
          highlight: '5명이 죽거나, 1명이 죽는다.',
          choices: [
            {
              id: 'pull',
              text: '레버를 당긴다',
              subtext: '1명을 희생하고 5명을 구한다',
              saved: 5,
              sacrificed: 1,
              meaning: '당신은 숫자를 계산했습니다. 5명의 생명이 1명보다 크다는 판단. 이것은 공리주의적 사고의 핵심입니다. 결과가 행위의 도덕성을 결정한다는 믿음.',
              principle: {
                name: '결과주의',
                desc: '도덕적 선택에서 가장 중요한 것은 결과다. 더 많은 생명을 구하는 선택이 옳다.',
                icon: '📊'
              },
              quote: '"최대 다수의 최대 행복" - 제러미 벤담'
            },
            {
              id: 'nothing',
              text: '아무것도 하지 않는다',
              subtext: '5명이 죽는 것을 지켜본다',
              saved: 1,
              sacrificed: 5,
              meaning: '당신은 행위와 방관을 구분했습니다. 트롤리가 5명을 치는 것은 당신 탓이 아니지만, 레버를 당겨 1명을 죽이는 것은 당신의 행위입니다. 칸트는 이것을 "인간을 수단으로 사용하지 말라"고 표현했습니다.',
              principle: {
                name: '행위의 도덕성',
                desc: '인간을 수단으로 사용해서는 안 된다. 어떤 결과를 위해 무고한 생명을 희생시키는 것은 그 자체로 잘못이다.',
                icon: '📜'
              },
              quote: '"네 의지의 준칙이 보편적 법칙이 될 수 있도록 행동하라" - 칸트'
            }
          ]
        },
        {
          badge: 'STAGE 2: 가치의 무게',
          title: '천재 의사',
          desc: '같은 상황이다. 트롤리가 달려오고, 5명이 위험에 처해 있다.\n\n하지만 이번에는 정보가 추가되었다. 다른 선로에 있는 1명은 천재 의사로, 앞으로 수천 명의 생명을 살릴 수 있는 사람이다.',
          highlight: '5명 vs 1명(+미래의 수천 명)',
          quote: '생명에 가치의 차등을 둘 수 있는가?',
          choices: [
            {
              id: 'pull_doctor',
              text: '그래도 레버를 당긴다',
              subtext: '지금 눈앞의 5명이 우선이다',
              saved: 5,
              sacrificed: 1,
              meaning: '당신은 불확실한 미래보다 확실한 현재를 선택했습니다. 미래의 가능성은 추측일 뿐, 지금 죽어가는 5명은 현실입니다. 이것은 실존주의적 선택이기도 합니다.',
              principle: {
                name: '현재의 확실성',
                desc: '불확실한 미래의 가치보다 확실한 현재의 생명이 우선한다.',
                icon: '⏱️'
              },
              quote: '"현재만이 우리가 가진 전부다" - 마르쿠스 아우렐리우스'
            },
            {
              id: 'nothing_doctor',
              text: '레버를 당기지 않는다',
              subtext: '더 큰 가치를 보존한다',
              saved: 1,
              sacrificed: 5,
              meaning: '당신은 생명의 잠재적 가치를 계산했습니다. 이것은 공리주의의 확장된 형태로, 단순한 숫자가 아닌 결과의 총합을 고려합니다. 하지만 이것은 위험한 논리이기도 합니다.',
              principle: {
                name: '가치의 계산',
                desc: '생명의 가치는 동등하지 않을 수 있다. 더 큰 선을 위한 판단이 필요할 때가 있다.',
                icon: '⚖️'
              },
              quote: '"더 큰 선을 위해 더 작은 악을 허용할 수 있는가?" - 공리주의의 딜레마'
            }
          ]
        },
        {
          badge: 'STAGE 3: 불완전한 정보',
          title: '연쇄살인범',
          desc: '이번에는 5명 중 1명이 연쇄살인범이라는 정보가 있다.\n\n하지만 누가 살인범인지는 알 수 없다.',
          highlight: '5명(살인범 포함) vs 1명(무고한 사람)',
          quote: '불완전한 정보로 생사를 결정할 수 있는가?',
          choices: [
            {
              id: 'pull_killer',
              text: '레버를 당긴다',
              subtext: '여전히 4명의 무고한 생명이 있다',
              saved: 5,
              sacrificed: 1,
              meaning: '당신은 확률을 계산했습니다. 5명 중 4명은 무고하고, 1명은 확실히 무고합니다. 숫자로만 보면 여전히 레버를 당기는 것이 합리적입니다. 하지만 살인범을 구할 수도 있다는 것을 알면서.',
              principle: {
                name: '확률적 판단',
                desc: '불완전한 정보 속에서도 최선의 확률을 선택해야 할 때가 있다.',
                icon: '🎲'
              },
              quote: '"확실성은 사치다" - 버트런드 러셀'
            },
            {
              id: 'nothing_killer',
              text: '레버를 당기지 않는다',
              subtext: '불확실한 상황에서 행동하지 않는다',
              saved: 1,
              sacrificed: 5,
              meaning: '당신은 불확실성 앞에서 멈췄습니다. 정보가 완벽하지 않을 때 행동을 보류하는 것은 신중함일 수도, 책임 회피일 수도 있습니다. 하지만 확실한 것은, 당신이 행위의 주체가 되지 않았다는 것입니다.',
              principle: {
                name: '신중한 불개입',
                desc: '불완전한 정보로 돌이킬 수 없는 결정을 내리는 것은 위험하다.',
                icon: '🛑'
              },
              quote: '"의심이 들 때는 행동하지 말라" - 키케로'
            }
          ]
        },
        {
          badge: 'STAGE 4: 개인적 관계',
          title: '당신의 가족',
          desc: '상황이 바뀌었다.\n\n이번에 다른 선로에 있는 1명은 당신의 가족이다.',
          highlight: '낯선 5명 vs 당신의 가족 1명',
          quote: '사랑하는 사람과 낯선 사람의 생명은 같은 무게인가?',
          choices: [
            {
              id: 'pull_family',
              text: '레버를 당긴다',
              subtext: '5명의 생명이 더 많다',
              saved: 5,
              sacrificed: 1,
              meaning: '당신은 감정을 배제하고 숫자를 계산했습니다. 이것은 극도로 어려운 선택이지만, 공리주의의 원칙을 끝까지 지킨 것입니다. 피터 싱어는 이것을 "효과적 이타주의"의 극단이라 부를 것입니다.',
              principle: {
                name: '보편적 공정',
                desc: '도덕적 판단에서 개인적 관계는 배제되어야 한다. 모든 생명은 동등하다.',
                icon: '⚖️'
              },
              quote: '"나의 아이와 낯선 아이의 생명은 같은 무게다" - 피터 싱어'
            },
            {
              id: 'nothing_family',
              text: '레버를 당기지 않는다',
              subtext: '가족을 희생시킬 수 없다',
              saved: 1,
              sacrificed: 5,
              meaning: '당신은 특별한 관계의 무게를 인정했습니다. 버나드 윌리엄스는 이것을 "도덕적 운"이라 불렀습니다. 우리는 모든 사람을 동등하게 사랑할 수 없고, 그것이 인간입니다.',
              principle: {
                name: '특별한 의무',
                desc: '가까운 사람에 대한 특별한 의무가 있다. 내 가족을 낯선 5명보다 우선시하는 것은 자연스러운 일이다.',
                icon: '👨‍👩‍👧'
              },
              quote: '"공정함은 때로 비인간적이다" - 버나드 윌리엄스'
            }
          ]
        },
        {
          badge: 'STAGE 5: 직접적 행위',
          title: '다리 위의 남자',
          desc: '이번에는 레버가 없다.\n\n당신은 다리 위에 서 있고, 옆에 덩치 큰 남자가 있다. 그를 밀어서 선로에 떨어뜨리면 트롤리가 멈춘다.\n\n5명이 살지만, 당신이 직접 한 사람을 밀어야 한다.',
          highlight: '간접적 행위와 직접적 행위는 같은가?',
          quote: '행위의 직접성이 도덕적 판단을 바꾸는가?',
          choices: [
            {
              id: 'push',
              text: '남자를 민다',
              subtext: '5명을 구하기 위해 직접 행동한다',
              saved: 5,
              sacrificed: 1,
              meaning: '당신은 끝까지 일관성을 유지했습니다. 레버를 당기든 사람을 밀든, 결과는 같습니다. 1명이 죽고 5명이 삽니다. 수단의 차이가 도덕적 판단을 바꿔서는 안 된다는 것이 당신의 입장입니다.',
              principle: {
                name: '결과의 동등성',
                desc: '행위의 방식이 아니라 결과가 도덕적 판단의 기준이다.',
                icon: '🎯'
              },
              quote: '"의도와 결과, 어느 것이 더 중요한가?" - 결과주의 vs 의무론의 핵심'
            },
            {
              id: 'not_push',
              text: '밀지 않는다',
              subtext: '직접 죽이는 것은 다르다',
              saved: 1,
              sacrificed: 5,
              meaning: '당신은 행위의 직접성을 구분했습니다. 대부분의 사람들이 여기서 멈춥니다. 레버를 당기는 것과 사람을 미는 것은 "느낌"이 다릅니다. 이것은 우리의 도덕적 직관이 일관적이지 않다는 것을 보여줍니다.',
              principle: {
                name: '도덕적 상대주의',
                desc: '도덕적 판단에 절대적 기준은 없다. 상황과 맥락에 따라 옳은 선택이 달라진다.',
                icon: '🎭'
              },
              quote: '"우리의 도덕적 직관은 논리적이지 않다" - 조슈아 그린'
            }
          ]
        }
      ],
      
      calculateResult(choices, principles) {
        const choiceIds = choices.map(c => c.choiceId);
        
        // saved/sacrificed 계산
        let totalSaved = 0;
        let totalSacrificed = 0;
        
        choices.forEach(c => {
          // 해당 스테이지의 선택지 찾기
          const stage = this.stages[c.stage];
          const choice = stage.choices.find(ch => ch.id === c.choiceId);
          if (choice) {
            totalSaved += choice.saved || 0;
            totalSacrificed += choice.sacrificed || 0;
          }
        });
        
        // 레버를 당긴 횟수
        const pullCount = choiceIds.filter(id => 
          id === 'pull' || id === 'pull_doctor' || id === 'pull_killer' || id === 'pull_family'
        ).length;
        
        // 직접 민 경우
        const pushed = choiceIds.includes('push');
        
        // 가족 구한 경우
        const savedFamily = choiceIds.includes('nothing_family');
        
        // 아무것도 안 한 횟수
        const nothingCount = choiceIds.filter(id => 
          id === 'nothing' || id === 'nothing_doctor' || id === 'nothing_killer' || id === 'nothing_family' || id === 'not_push'
        ).length;
        
        // 기본 stats
        const stats = [
          { value: totalSaved + '명', label: '구한 생명' },
          { value: totalSacrificed + '명', label: '희생시킨 생명' }
        ];
        
        if (pullCount >= 3 && pushed) {
          return {
            icon: '📊',
            label: '당신의 도덕 유형',
            title: '철저한 공리주의자',
            stats: stats,
            desc: '당신은 결과를 중시합니다. "최대 다수의 최대 행복"이 당신의 기준입니다. 숫자로 계산할 수 있는 것, 측정 가능한 결과가 옳고 그름의 기준이 됩니다.\n\n이것은 냉정해 보일 수 있지만, 감정에 휘둘리지 않는 합리적 판단이기도 합니다.'
          };
        } else if (nothingCount >= 4) {
          return {
            icon: '📜',
            label: '당신의 도덕 유형',
            title: '엄격한 의무론자',
            stats: stats,
            desc: '당신은 행위 자체의 옳고 그름을 중시합니다. 아무리 좋은 결과를 위해서라도 "하지 말아야 할 것"이 있다고 믿습니다.\n\n"목적이 수단을 정당화하지 않는다"는 칸트의 말이 당신의 철학입니다.'
          };
        } else if (savedFamily) {
          return {
            icon: '👨‍👩‍👧',
            label: '당신의 도덕 유형',
            title: '관계 중심주의자',
            stats: stats,
            desc: '당신에게는 모든 생명이 동등하지 않습니다. 가족, 친구, 낯선 사람 - 관계에 따라 도덕적 의무도 달라진다고 생각합니다.\n\n이것은 "불공평"이 아니라 인간 본성에 충실한 것일 수 있습니다.'
          };
        } else {
          return {
            icon: '🎭',
            label: '당신의 도덕 유형',
            title: '상황적 판단자',
            stats: stats,
            desc: '당신은 고정된 원칙보다 상황의 맥락을 중시합니다. 같은 "5명 vs 1명"도 누가 관련되어 있는지, 어떤 행위가 필요한지에 따라 판단이 달라집니다.\n\n이것은 유연함이자, 동시에 일관성의 부재일 수 있습니다.'
          };
        }
      },
      
      getShareText(resultTitle, choices, principles) {
        // saved/sacrificed 계산
        let totalSaved = 0;
        let totalSacrificed = 0;
        
        choices.forEach(c => {
          const stage = this.stages[c.stage];
          const choice = stage.choices.find(ch => ch.id === c.choiceId);
          if (choice) {
            totalSaved += choice.saved || 0;
            totalSacrificed += choice.sacrificed || 0;
          }
        });
        
        // 첫 번째 원칙의 설명을 인용구로
        const quote = principles.length > 0 ? principles[0].desc : '';
        
        return `🚃 트롤리 딜레마 결과

나의 도덕 유형: ${resultTitle}
구한 생명: ${totalSaved}명
희생시킨 생명: ${totalSacrificed}명

"${quote}"

${this.shareUrl}`;
      }
    };

    SimTemplate.init(CONFIG);
  </script>
</body>
</html>
